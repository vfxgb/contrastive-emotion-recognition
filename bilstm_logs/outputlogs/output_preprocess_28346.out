Activating environment
CUDA_HOME is set to: /tc1apps/cuda/11.8
Checking GPU availability
CUDA available: True
Current device: Tesla V100-PCIE-32GB
Downloading spaCy model
Collecting en-core-web-sm==3.8.0
  Downloading https://github.com/explosion/spacy-models/releases/download/en_core_web_sm-3.8.0/en_core_web_sm-3.8.0-py3-none-any.whl (12.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 12.8/12.8 MB 19.9 MB/s eta 0:00:00
[38;5;2m✔ Download and installation successful[0m
You can now load the package via spacy.load('en_core_web_sm')
Running script
[Main] Loading and processing WASSA 2021 dataset...
First 10 lines of the TSV file:
message_id	response_id	empathy	distress	empathy_bin	distress_bin	emotion_label	essay	gender	education	race	age	income	personality_conscientiousness	personality_openess	personality_extraversion	personality_agreeableness	personality_stability	iri_perspective_taking	iri_personal_distress	iri_fantasy	iri_empathatic_concern
R_1hGrPtWM4SumG0U_1	R_1hGrPtWM4SumG0U	5.667	4.375	1	1	sadness	it is really diheartening to read about these immigrants from this article who drowned.  it makes me feel anxious and upset how the whole ordeal happened.  it is a terrible occurrence that this had to happen at the mediterranean sea.  thankfully there were some survivors.  the fact that babies were lost makes it that much more emotional to read all of this	1	4	1	33	50000	6	5	5	5.5	5.5	3.571	2	3.429	4
R_1hGrPtWM4SumG0U_2	R_1hGrPtWM4SumG0U	4.833	4.875	1	1	joy	the phone lines from the suicide prevention line surged after the election.  it also climbed when robin williams committed suciide.  thankfully there is this prevention line to help those in need who have sucidal thoughts but we need to condition people that committing sucide is a permanent solution to a temporary problem	1	4	1	33	50000	6	5	5	5.5	5.5	3.571	2	3.429	4
R_1hGrPtWM4SumG0U_3	R_1hGrPtWM4SumG0U	5.333	3.5	1	0	neutral	"no matter what your heritage, you should be able to serve your country.  her thai heritage shouldn't preclude her and shouldn't have been an issue in this debate.  tammy duckworth and her family should be congratulated on the services they have provided to this country.  any type of racism should not be allowed in a debate"	1	4	1	33	50000	6	5	5	5.5	5.5	3.571	2	3.429	4
R_1hGrPtWM4SumG0U_4	R_1hGrPtWM4SumG0U	4.167	5.25	1	1	fear	it is frightening to learn about all these shark attacks but these surfers should be aware of the risks associated with the sport.  relocating the sharks should be a priority and it would be in the best interest to establish a moratorium on water sports until the shark epidemic is dealt with.  closing beach in australia is a good precautionary method	1	4	1	33	50000	6	5	5	5.5	5.5	3.571	2	3.429	4
R_1hGrPtWM4SumG0U_5	R_1hGrPtWM4SumG0U	5.333	4.625	1	1	neutral	"the eldest generation of russians aren't being treated properly and should have some sort of financial compensation.  they are living off very little per day financially and live in poor conditions.  after paying utilities, they barely have enough for food.  health care has also taken a turn for the worse because they can't afford to get proper health treatment due to the costs involved"	1	4	1	33	50000	6	5	5	5.5	5.5	3.571	2	3.429	4
R_1jl9vLqdDRf4Epg_1	R_1jl9vLqdDRf4Epg	2.333	3.125	0	0	anger	"middle east is fucked up, I've honestly never heard of a middle east country such as Afganistan deporting people, the mention of it just sound funny, who the heck would want to stay in that shit hole country that has been infested with terrorists and child rapists? Perhaps those refugees are out of choice, honestly they should come to a better country such as U.S. or U.K, even though those 2 countries have their own policies regarding immigration, but I think they're quite tolerate to people from war torn countries"	1	6	5	24	45000	4.5	3	4.5	4.5	4.5	2.429	2.857	2.714	2.429
R_1jl9vLqdDRf4Epg_2	R_1jl9vLqdDRf4Epg	2.167	2.875	0	0	sadness	"well first of all whoever wrote this article doesn't know how to properly divide an article into paragraphs, which made reading this article extremely painful, but nonetheless I do know after reading the article that Zika virus tend to stay in semen and vaginal fluid for extended amount of time, so it's obvious don't mate with people who have zika virus, and don't even think about having a baby, they're going to be defective"	1	6	5	24	45000	4.5	3	4.5	4.5	4.5	2.429	2.857	2.714	2.429
R_1jl9vLqdDRf4Epg_3	R_1jl9vLqdDRf4Epg	3.833	4.25	0	1	neutral	"well well well, look at what we have well, the arrogant Kim Kardashian finally got what she deserves: being robbed for millions, the thought of it is bitter, considering it's a robbery after all, but think the other way, a rich superfluous gal as Kim, broadcasting her belongings on social media, I guess she brought this upon herself"	1	6	5	24	45000	4.5	3	4.5	4.5	4.5	2.429	2.857	2.714	2.429
R_1jl9vLqdDRf4Epg_4	R_1jl9vLqdDRf4Epg	3.167	3.375	0	0	anger	"just another fucked up mental sickness of american police against its black residents, I honestly have no idea why they have to be so sensitive with their fucking guns, they shoot people as if people can respawn after being shot or something, police should think twice before taking out people's lives with no legitimate reason, I guess it's good that police have body cam, so the public can see what shame they are brining upon themselves"	1	6	5	24	45000	4.5	3	4.5	4.5	4.5	2.429	2.857	2.714	2.429
Loading TSV from: data/WASSA2021/wassa_2021.tsv
Original dataset shape: (1860, 22)
Columns in dataset: ['message_id', 'response_id', 'empathy', 'distress', 'empathy_bin', 'distress_bin', 'emotion_label', 'essay', 'gender', 'education', 'race', 'age', 'income', 'personality_conscientiousness', 'personality_openess', 'personality_extraversion', 'personality_agreeableness', 'personality_stability', 'iri_perspective_taking', 'iri_personal_distress', 'iri_fantasy', 'iri_empathatic_concern']
Renamed columns: 'emotion_labels' -> 'Emotion', 'essays' -> 'Text'
Original label distribution in 'Emotion':
Emotion
sadness     481
neutral     383
surprise    317
joy         277
fear        180
anger       179
disgust      43
Name: count, dtype: int64
Filtered dataset shape: (1477, 22)
Filtered label distribution:
Emotion
sadness     481
surprise    317
joy         277
fear        180
anger       179
disgust      43
Name: count, dtype: int64
Sample cleaned text: it be really diheartene to read about these immigrant from this article who drown it make I feel anxious and upset how the whole ordeal happen it be a terrible occurrence that this have to happen at the mediterranean sea thankfully there be some survivor the fact that baby be lose make it that much more emotional to read all of this
Tokenization complete.
Input IDs shape: torch.Size([1477, 128])
Attention mask shape: torch.Size([1477, 128])
Labels tensor shape: torch.Size([1477])
Unique label mapping: {'anger': 0, 'sadness': 1, 'disgust': 2, 'fear': 3, 'joy': 4, 'surprise': 5}
WASSA 2021 dataset loaded: 1477 samples

Sample from dataset:
Input IDs: [101, 2009, 2022, 2428, 4487, 22375, 8625, 2000, 3191, 2055, 2122, 11560, 2013, 2023, 3720, 2040, 19549, 2009, 2191, 1045, 2514, 11480, 1998, 6314, 2129, 1996, 2878, 23304, 4148, 2009, 2022, 1037, 6659, 14404, 2008, 2023, 2031, 2000, 4148, 2012, 1996, 7095, 2712, 16047, 2045, 2022, 2070, 12084, 1996, 2755, 2008, 3336, 2022, 4558, 2191, 2009, 2008, 2172, 2062, 6832, 2000, 3191, 2035, 1997, 2023, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Attention mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Label: 1

Train/Test split:
Total samples: 1477
Train size: 1181
Test size: 296

Train label distribution:
0    142
1    374
2     35
3    136
4    222
5    272
Name: count, dtype: int64

Test label distribution:
0     37
1    107
2      8
3     44
4     55
5     45
Name: count, dtype: int64

Datasets prepared and saved:
- WASSA 2021 dual-view train: 1181 samples
- WASSA 2021 test: 296 samples
