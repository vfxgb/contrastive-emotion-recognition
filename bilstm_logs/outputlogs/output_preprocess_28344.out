Activating environment
CUDA_HOME is set to: /tc1apps/cuda/11.8
Checking GPU availability
CUDA available: True
Current device: Tesla V100-PCIE-32GB
Downloading spaCy model
Collecting en-core-web-sm==3.8.0
  Downloading https://github.com/explosion/spacy-models/releases/download/en_core_web_sm-3.8.0/en_core_web_sm-3.8.0-py3-none-any.whl (12.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 12.8/12.8 MB 9.9 MB/s eta 0:00:00
[38;5;2m✔ Download and installation successful[0m
You can now load the package via spacy.load('en_core_web_sm')
Running script
[Main] Loading and processing ISEAR dataset...
First 10 lines of the CSV file:
b'ID,CITY,COUN,SUBJ,SEX,AGE,RELI,PRAC,FOCC,MOCC,FIEL,EMOT,WHEN,LONG,INTS,ERGO,TROPHO,TEMPER,EXPRES,MOVE,EXP1,EXP2,EXP10,PARAL,CON,EXPC,PLEA,PLAN,FAIR,CAUS,COPING,MORL,SELF,RELA,VERBAL,NEUTRO,Field1,Field3,Field2,MYKEY,SIT,STATE\n'
b'11001,1,1,1,1,33,1,2,6,1,2,1,4,4,3,0,0,1,1,0,1,0,0,0,1,2,1,1,1,4,4,2,3,3,2,0,"joy",4,3,"0110011","During the period of falling in love, each time that we met and \xc3\xa1\n'
b'especially when we had not met for a long time.","1"\n'
b'11001,1,1,1,1,33,1,2,6,1,2,2,4,3,2,2,0,0,1,0,0,0,0,2,1,1,3,0,2,2,1,3,2,2,0,0,"fear",3,2,"0110012","When I was involved in a traffic accident.","1"\n'
b'11001,1,1,1,1,33,1,2,6,1,2,3,4,1,3,0,0,0,2,0,0,0,0,1,1,1,3,3,0,3,1,2,2,1,0,0,"anger",1,3,"0110013","When I was driving home after  several days of hard work, there \xc3\xa1\n'
b'was a motorist ahead of me who was driving at 50 km/hour and \xc3\xa1\n'
b'refused, despite his low speeed to let me overtake.","1"\n'
b'11001,1,1,1,1,33,1,2,6,1,2,4,4,4,4,1,1,0,1,0,0,1,0,1,2,1,3,3,3,3,5,0,1,1,0,2,"sadness",4,4,"0110014","When I lost the person who meant the most to me. ","1"\n'
b'11001,1,1,1,1,33,1,2,6,1,2,5,4,4,4,3,0,0,0,0,0,0,0,1,1,1,3,0,0,4,1,0,0,2,0,0,"disgust",4,4,"0110015","The time I knocked a deer down - the sight of the animal\'s \xc3\xa1\n'
b'injuries and helplessness.  The realization that the animal was \xc3\xa1\n'
Loading CSV from: data/ISEAR/isear_data.csv
Original dataset shape: (7666, 42)
Columns in dataset: ['ID', 'CITY', 'COUN', 'SUBJ', 'SEX', 'AGE', 'RELI', 'PRAC', 'FOCC', 'MOCC', 'FIEL', 'EMOT', 'WHEN', 'LONG', 'INTS', 'ERGO', 'TROPHO', 'TEMPER', 'EXPRES', 'MOVE', 'EXP1', 'EXP2', 'EXP10', 'PARAL', 'CON', 'EXPC', 'PLEA', 'PLAN', 'FAIR', 'CAUS', 'COPING', 'MORL', 'SELF', 'RELA', 'VERBAL', 'NEUTRO', 'Field1', 'Field3', 'Field2', 'MYKEY', 'SIT', 'STATE']
Renamed columns: 'Field1' -> 'Emotion', 'SIT' -> 'Text'
Original label distribution in 'Emotion':
Emotion
anger      1096
sadness    1096
disgust    1096
shame      1096
fear       1095
joy        1094
guilt      1093
Name: count, dtype: int64
Filtered dataset shape: (7666, 42)
Filtered label distribution:
Emotion
anger      1096
sadness    1096
disgust    1096
shame      1096
fear       1095
joy        1094
guilt      1093
Name: count, dtype: int64
Sample cleaned text: during the period of fall in love each time that we meet and ã ¡ especially when we have not meet for a long time
Tokenization complete.
Input IDs shape: torch.Size([7666, 128])
Attention mask shape: torch.Size([7666, 128])
Labels tensor shape: torch.Size([7666])
Unique label mapping: {'anger': 0, 'sadness': 1, 'disgust': 2, 'shame': 3, 'fear': 4, 'joy': 5, 'guilt': 6}
ISEAR dataset loaded: 7666 samples

Sample from dataset:
Input IDs: [101, 2076, 1996, 2558, 1997, 2991, 1999, 2293, 2169, 2051, 2008, 2057, 3113, 1998, 1037, 1067, 2926, 2043, 2057, 2031, 2025, 3113, 2005, 1037, 2146, 2051, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Attention mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Label: 5

Train/Test split:
Total samples: 7666
Train size: 6132
Test size: 1534
Overlap between train and test indices (should be empty): 19

Train label distribution:
0    891
1    882
2    881
3    866
4    868
5    880
6    864
Name: count, dtype: int64

Test label distribution:
0    205
1    214
2    215
3    230
4    227
5    214
6    229
Name: count, dtype: int64

Datasets prepared and saved:
- ISEAR train: 6132 samples
- ISEAR test: 1534 samples
