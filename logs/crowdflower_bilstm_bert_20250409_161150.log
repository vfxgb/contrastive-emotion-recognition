2025-04-09 21:09:44.910378: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-09 21:09:45.646084: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
[Main] Loading and processing CrowdFlower dataset...
[Main] Dataset already preprocessed. Skipping...
[Main] Done.
2025-04-09 21:10:11.825541: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-09 21:10:11.898336: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.

 🌟🌟 Model Configuration : {'name': 'bilstm_bert', 'bert_model_name': 'bert-large-uncased', 'hidden_dim': 256, 'dropout_rate': 0.3, 'lstm_layers': 1, 'num_epochs': 30, 'learning_rate': 6e-05, 'finetune_learning_rate': 6e-05, 'batch_size': 1024, 'finetune_batch_size': 32, 'device': device(type='cuda'), 'model_save_path': 'results/bilstm_bert/bilstm_bert.pt', 'isear_finetune_save_path': 'results/bilstm_bert/isear_finetune_bilstm_bert.pt', 'wassa21_finetune_save_path': 'results/bilstm_bert/wassa21_finetune_bilstm_bert.pt'}, Dataset : CROWDFLOWER
Using device : cuda
Loading training data...
[Split] Train size: 26998, Test size: 3000
Number of samples in test_ds: 7500
Number of samples in train_ds: 26998
Number of samples in val_ds: 3000
Batch size:  1024

Epoch 1:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 1:   4%|▎         | 1/27 [00:08<03:30,  8.10s/it]
Epoch 1:   7%|▋         | 2/27 [00:16<03:20,  8.03s/it]
Epoch 1:  11%|█         | 3/27 [00:24<03:12,  8.02s/it]
Epoch 1:  15%|█▍        | 4/27 [00:32<03:04,  8.03s/it]
Epoch 1:  19%|█▊        | 5/27 [00:40<02:56,  8.04s/it]
Epoch 1:  22%|██▏       | 6/27 [00:48<02:49,  8.08s/it]
Epoch 1:  26%|██▌       | 7/27 [00:57<02:47,  8.37s/it]
Epoch 1:  30%|██▉       | 8/27 [01:07<02:49,  8.93s/it]
Epoch 1:  33%|███▎      | 9/27 [01:20<03:01, 10.07s/it]
Epoch 1:  37%|███▋      | 10/27 [01:34<03:14, 11.44s/it]
Epoch 1:  41%|████      | 11/27 [01:50<03:26, 12.89s/it]
Epoch 1:  44%|████▍     | 12/27 [02:05<03:20, 13.38s/it]
Epoch 1:  48%|████▊     | 13/27 [02:20<03:16, 14.02s/it]
Epoch 1:  52%|█████▏    | 14/27 [02:36<03:07, 14.46s/it]
Epoch 1:  56%|█████▌    | 15/27 [02:51<02:57, 14.77s/it]
Epoch 1:  59%|█████▉    | 16/27 [03:07<02:44, 14.98s/it]
Epoch 1:  63%|██████▎   | 17/27 [03:22<02:31, 15.14s/it]
Epoch 1:  67%|██████▋   | 18/27 [03:38<02:17, 15.23s/it]
Epoch 1:  70%|███████   | 19/27 [03:53<02:01, 15.17s/it]
Epoch 1:  74%|███████▍  | 20/27 [04:06<01:42, 14.69s/it]
Epoch 1:  78%|███████▊  | 21/27 [04:20<01:26, 14.38s/it]
Epoch 1:  81%|████████▏ | 22/27 [04:34<01:11, 14.34s/it]
Epoch 1:  85%|████████▌ | 23/27 [04:48<00:57, 14.31s/it]
Epoch 1:  89%|████████▉ | 24/27 [05:03<00:42, 14.29s/it]
Epoch 1:  93%|█████████▎| 25/27 [05:17<00:28, 14.26s/it]
Epoch 1:  96%|█████████▋| 26/27 [05:31<00:14, 14.23s/it]
Epoch 1: 100%|██████████| 27/27 [05:36<00:00, 11.40s/it]
Epoch 1: 100%|██████████| 27/27 [05:36<00:00, 12.45s/it]
[Epoch 1] Training Loss: 2.0908

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:11<00:22, 11.29s/it]
Validation:  67%|██████▋   | 2/3 [00:22<00:11, 11.29s/it]
Validation: 100%|██████████| 3/3 [00:33<00:00, 10.97s/it]
Validation: 100%|██████████| 3/3 [00:33<00:00, 11.06s/it]
Accuracy: 26.90%, F1 Score: 0.0779

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.00      0.00      0.00       409
           2       0.00      0.00      0.00       105
           3       0.00      0.00      0.00       298
           4       0.29      0.30      0.29       673
           5       0.00      0.00      0.00       121
           6       0.00      0.00      0.00       410
           7       0.00      0.00      0.00       173
           8       0.26      0.91      0.41       669

    accuracy                           0.27      3000
   macro avg       0.06      0.13      0.08      3000
weighted avg       0.12      0.27      0.16      3000

Best model saved at epoch 1 with accuracy: 0.2690 and f1 score: 0.0779

Epoch 2:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 2:   4%|▎         | 1/27 [00:10<04:21, 10.07s/it]
Epoch 2:   7%|▋         | 2/27 [00:22<04:43, 11.34s/it]
Epoch 2:  11%|█         | 3/27 [00:34<04:42, 11.75s/it]
Epoch 2:  15%|█▍        | 4/27 [00:47<04:39, 12.15s/it]
Epoch 2:  19%|█▊        | 5/27 [01:00<04:39, 12.69s/it]
Epoch 2:  22%|██▏       | 6/27 [01:14<04:33, 13.00s/it]
Epoch 2:  26%|██▌       | 7/27 [01:28<04:24, 13.20s/it]
Epoch 2:  30%|██▉       | 8/27 [01:41<04:13, 13.34s/it]
Epoch 2:  33%|███▎      | 9/27 [01:55<04:01, 13.42s/it]
Epoch 2:  37%|███▋      | 10/27 [02:09<03:49, 13.48s/it]
Epoch 2:  41%|████      | 11/27 [02:22<03:36, 13.52s/it]
Epoch 2:  44%|████▍     | 12/27 [02:36<03:23, 13.54s/it]
Epoch 2:  48%|████▊     | 13/27 [02:49<03:09, 13.57s/it]
Epoch 2:  52%|█████▏    | 14/27 [03:03<02:56, 13.58s/it]
Epoch 2:  56%|█████▌    | 15/27 [03:17<02:43, 13.59s/it]
Epoch 2:  59%|█████▉    | 16/27 [03:30<02:29, 13.58s/it]
Epoch 2:  63%|██████▎   | 17/27 [03:44<02:15, 13.58s/it]
Epoch 2:  67%|██████▋   | 18/27 [03:57<02:02, 13.58s/it]
Epoch 2:  70%|███████   | 19/27 [04:11<01:48, 13.58s/it]
Epoch 2:  74%|███████▍  | 20/27 [04:24<01:33, 13.36s/it]
Epoch 2:  78%|███████▊  | 21/27 [04:37<01:19, 13.24s/it]
Epoch 2:  81%|████████▏ | 22/27 [04:50<01:06, 13.36s/it]
Epoch 2:  85%|████████▌ | 23/27 [05:04<00:53, 13.45s/it]
Epoch 2:  89%|████████▉ | 24/27 [05:18<00:40, 13.62s/it]
Epoch 2:  93%|█████████▎| 25/27 [05:32<00:27, 13.72s/it]
Epoch 2:  96%|█████████▋| 26/27 [05:47<00:14, 14.25s/it]
Epoch 2: 100%|██████████| 27/27 [05:53<00:00, 11.54s/it]
Epoch 2: 100%|██████████| 27/27 [05:53<00:00, 13.08s/it]
[Epoch 2] Training Loss: 1.9330

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:12<00:24, 12.21s/it]
Validation:  67%|██████▋   | 2/3 [00:23<00:11, 11.93s/it]
Validation: 100%|██████████| 3/3 [00:34<00:00, 11.45s/it]
Validation: 100%|██████████| 3/3 [00:34<00:00, 11.61s/it]
Accuracy: 34.10%, F1 Score: 0.1430

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.30      0.66      0.42       409
           2       0.00      0.00      0.00       105
           3       0.00      0.00      0.00       298
           4       0.36      0.51      0.42       673
           5       0.00      0.00      0.00       121
           6       0.00      0.00      0.00       410
           7       0.00      0.00      0.00       173
           8       0.35      0.61      0.45       669

    accuracy                           0.34      3000
   macro avg       0.11      0.20      0.14      3000
weighted avg       0.20      0.34      0.25      3000

Best model saved at epoch 2 with accuracy: 0.3410 and f1 score: 0.1430

Epoch 3:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 3:   4%|▎         | 1/27 [00:10<04:34, 10.54s/it]
Epoch 3:   7%|▋         | 2/27 [00:23<04:53, 11.73s/it]
Epoch 3:  11%|█         | 3/27 [00:36<05:01, 12.56s/it]
Epoch 3:  15%|█▍        | 4/27 [00:50<04:58, 12.97s/it]
Epoch 3:  19%|█▊        | 5/27 [01:03<04:50, 13.19s/it]
Epoch 3:  22%|██▏       | 6/27 [01:17<04:39, 13.33s/it]
Epoch 3:  26%|██▌       | 7/27 [01:30<04:28, 13.41s/it]
Epoch 3:  30%|██▉       | 8/27 [01:44<04:15, 13.46s/it]
Epoch 3:  33%|███▎      | 9/27 [01:58<04:02, 13.50s/it]
Epoch 3:  37%|███▋      | 10/27 [02:11<03:49, 13.52s/it]
Epoch 3:  41%|████      | 11/27 [02:25<03:36, 13.53s/it]
Epoch 3:  44%|████▍     | 12/27 [02:38<03:23, 13.54s/it]
Epoch 3:  48%|████▊     | 13/27 [02:52<03:09, 13.55s/it]
Epoch 3:  52%|█████▏    | 14/27 [03:05<02:56, 13.55s/it]
Epoch 3:  56%|█████▌    | 15/27 [03:19<02:42, 13.56s/it]
Epoch 3:  59%|█████▉    | 16/27 [03:33<02:29, 13.57s/it]
Epoch 3:  63%|██████▎   | 17/27 [03:47<02:17, 13.70s/it]
Epoch 3:  67%|██████▋   | 18/27 [04:01<02:04, 13.85s/it]
Epoch 3:  70%|███████   | 19/27 [04:15<01:51, 13.96s/it]
Epoch 3:  74%|███████▍  | 20/27 [04:29<01:38, 14.03s/it]
Epoch 3:  78%|███████▊  | 21/27 [04:43<01:24, 14.07s/it]
Epoch 3:  81%|████████▏ | 22/27 [04:58<01:10, 14.11s/it]
Epoch 3:  85%|████████▌ | 23/27 [05:12<00:56, 14.13s/it]
Epoch 3:  89%|████████▉ | 24/27 [05:26<00:42, 14.14s/it]
Epoch 3:  93%|█████████▎| 25/27 [05:40<00:28, 14.15s/it]
Epoch 3:  96%|█████████▋| 26/27 [05:54<00:14, 14.17s/it]
Epoch 3: 100%|██████████| 27/27 [05:59<00:00, 11.45s/it]
Epoch 3: 100%|██████████| 27/27 [05:59<00:00, 13.33s/it]
[Epoch 3] Training Loss: 1.7999

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:11<00:23, 11.94s/it]
Validation:  67%|██████▋   | 2/3 [00:23<00:11, 11.95s/it]
Validation: 100%|██████████| 3/3 [00:35<00:00, 11.66s/it]
Validation: 100%|██████████| 3/3 [00:35<00:00, 11.74s/it]
Accuracy: 36.60%, F1 Score: 0.1533

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.32      0.67      0.43       409
           2       0.00      0.00      0.00       105
           3       0.00      0.00      0.00       298
           4       0.42      0.57      0.48       673
           5       0.00      0.00      0.00       121
           6       0.00      0.00      0.00       410
           7       0.00      0.00      0.00       173
           8       0.36      0.66      0.46       669

    accuracy                           0.37      3000
   macro avg       0.12      0.21      0.15      3000
weighted avg       0.22      0.37      0.27      3000

Best model saved at epoch 3 with accuracy: 0.3660 and f1 score: 0.1533

Epoch 4:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 4:   4%|▎         | 1/27 [00:10<04:33, 10.50s/it]
Epoch 4:   7%|▋         | 2/27 [00:24<05:11, 12.45s/it]
Epoch 4:  11%|█         | 3/27 [00:37<05:10, 12.94s/it]
Epoch 4:  15%|█▍        | 4/27 [00:51<05:06, 13.33s/it]
Epoch 4:  19%|█▊        | 5/27 [01:05<04:59, 13.62s/it]
Epoch 4:  22%|██▏       | 6/27 [01:20<04:49, 13.79s/it]
Epoch 4:  26%|██▌       | 7/27 [01:34<04:37, 13.89s/it]
Epoch 4:  30%|██▉       | 8/27 [01:48<04:25, 13.97s/it]
Epoch 4:  33%|███▎      | 9/27 [02:02<04:12, 14.01s/it]
Epoch 4:  37%|███▋      | 10/27 [02:16<03:58, 14.04s/it]
Epoch 4:  41%|████      | 11/27 [02:30<03:45, 14.07s/it]
Epoch 4:  44%|████▍     | 12/27 [02:44<03:30, 14.05s/it]
Epoch 4:  48%|████▊     | 13/27 [02:57<03:13, 13.82s/it]
Epoch 4:  52%|█████▏    | 14/27 [03:11<02:57, 13.68s/it]
Epoch 4:  56%|█████▌    | 15/27 [03:24<02:43, 13.61s/it]
Epoch 4:  59%|█████▉    | 16/27 [03:38<02:29, 13.58s/it]
Epoch 4:  63%|██████▎   | 17/27 [03:51<02:15, 13.56s/it]
Epoch 4:  67%|██████▋   | 18/27 [04:05<02:01, 13.55s/it]
Epoch 4:  70%|███████   | 19/27 [04:18<01:48, 13.54s/it]
Epoch 4:  74%|███████▍  | 20/27 [04:32<01:34, 13.54s/it]
Epoch 4:  78%|███████▊  | 21/27 [04:45<01:21, 13.53s/it]
Epoch 4:  81%|████████▏ | 22/27 [04:59<01:07, 13.53s/it]
Epoch 4:  85%|████████▌ | 23/27 [05:12<00:54, 13.53s/it]
Epoch 4:  89%|████████▉ | 24/27 [05:26<00:40, 13.54s/it]
Epoch 4:  93%|█████████▎| 25/27 [05:40<00:27, 13.56s/it]
Epoch 4:  96%|█████████▋| 26/27 [05:54<00:13, 13.85s/it]
Epoch 4: 100%|██████████| 27/27 [05:59<00:00, 11.26s/it]
Epoch 4: 100%|██████████| 27/27 [05:59<00:00, 13.33s/it]
[Epoch 4] Training Loss: 1.7357

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:12<00:24, 12.22s/it]
Validation:  67%|██████▋   | 2/3 [00:24<00:12, 12.21s/it]
Validation: 100%|██████████| 3/3 [00:36<00:00, 11.92s/it]
Validation: 100%|██████████| 3/3 [00:36<00:00, 12.00s/it]
Accuracy: 38.43%, F1 Score: 0.1969

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.32      0.67      0.43       409
           2       0.00      0.00      0.00       105
           3       0.51      0.21      0.30       298
           4       0.46      0.57      0.51       673
           5       0.00      0.00      0.00       121
           6       0.19      0.04      0.06       410
           7       0.00      0.00      0.00       173
           8       0.38      0.62      0.47       669

    accuracy                           0.38      3000
   macro avg       0.21      0.23      0.20      3000
weighted avg       0.31      0.38      0.32      3000

Best model saved at epoch 4 with accuracy: 0.3843 and f1 score: 0.1969

Epoch 5:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 5:   4%|▎         | 1/27 [00:10<04:35, 10.61s/it]
Epoch 5:   7%|▋         | 2/27 [00:23<04:53, 11.73s/it]
Epoch 5:  11%|█         | 3/27 [00:36<05:01, 12.55s/it]
Epoch 5:  15%|█▍        | 4/27 [00:50<04:57, 12.95s/it]
Epoch 5:  19%|█▊        | 5/27 [01:04<04:53, 13.34s/it]
Epoch 5:  22%|██▏       | 6/27 [01:18<04:45, 13.58s/it]
Epoch 5:  26%|██▌       | 7/27 [01:32<04:34, 13.72s/it]
Epoch 5:  30%|██▉       | 8/27 [01:46<04:22, 13.82s/it]
Epoch 5:  33%|███▎      | 9/27 [02:00<04:09, 13.87s/it]
Epoch 5:  37%|███▋      | 10/27 [02:14<03:56, 13.91s/it]
Epoch 5:  41%|████      | 11/27 [02:28<03:42, 13.93s/it]
Epoch 5:  44%|████▍     | 12/27 [02:41<03:26, 13.75s/it]
Epoch 5:  48%|████▊     | 13/27 [02:54<03:10, 13.59s/it]
Epoch 5:  52%|█████▏    | 14/27 [03:08<02:55, 13.48s/it]
Epoch 5:  56%|█████▌    | 15/27 [03:21<02:40, 13.41s/it]
Epoch 5:  59%|█████▉    | 16/27 [03:34<02:26, 13.36s/it]
Epoch 5:  63%|██████▎   | 17/27 [03:48<02:16, 13.60s/it]
Epoch 5:  67%|██████▋   | 18/27 [04:03<02:04, 13.82s/it]
Epoch 5:  70%|███████   | 19/27 [04:17<01:51, 13.98s/it]
Epoch 5:  74%|███████▍  | 20/27 [04:31<01:38, 14.08s/it]
Epoch 5:  78%|███████▊  | 21/27 [04:46<01:24, 14.16s/it]
Epoch 5:  81%|████████▏ | 22/27 [05:00<01:11, 14.21s/it]
Epoch 5:  85%|████████▌ | 23/27 [05:14<00:56, 14.21s/it]
Epoch 5:  89%|████████▉ | 24/27 [05:28<00:41, 13.99s/it]
Epoch 5:  93%|█████████▎| 25/27 [05:41<00:27, 13.84s/it]
Epoch 5:  96%|█████████▋| 26/27 [05:55<00:13, 13.89s/it]
Epoch 5: 100%|██████████| 27/27 [06:00<00:00, 11.28s/it]
Epoch 5: 100%|██████████| 27/27 [06:00<00:00, 13.36s/it]
[Epoch 5] Training Loss: 1.6969

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:12<00:24, 12.17s/it]
Validation:  67%|██████▋   | 2/3 [00:24<00:12, 12.17s/it]
Validation: 100%|██████████| 3/3 [00:35<00:00, 11.89s/it]
Validation: 100%|██████████| 3/3 [00:35<00:00, 11.96s/it]
Accuracy: 38.47%, F1 Score: 0.2045

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.32      0.53      0.40       409
           2       0.00      0.00      0.00       105
           3       0.40      0.42      0.41       298
           4       0.43      0.62      0.51       673
           5       0.00      0.00      0.00       121
           6       0.22      0.04      0.06       410
           7       0.00      0.00      0.00       173
           8       0.39      0.57      0.47       669

    accuracy                           0.38      3000
   macro avg       0.20      0.24      0.20      3000
weighted avg       0.30      0.38      0.32      3000

Best model saved at epoch 5 with accuracy: 0.3847 and f1 score: 0.2045

Epoch 6:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 6:   4%|▎         | 1/27 [00:10<04:36, 10.62s/it]
Epoch 6:   7%|▋         | 2/27 [00:24<05:14, 12.57s/it]
Epoch 6:  11%|█         | 3/27 [00:38<05:16, 13.19s/it]
Epoch 6:  15%|█▍        | 4/27 [00:51<05:03, 13.20s/it]
Epoch 6:  19%|█▊        | 5/27 [01:05<04:54, 13.38s/it]
Epoch 6:  22%|██▏       | 6/27 [01:19<04:44, 13.57s/it]
Epoch 6:  26%|██▌       | 7/27 [01:33<04:33, 13.66s/it]
Epoch 6:  30%|██▉       | 8/27 [01:47<04:22, 13.84s/it]
Epoch 6:  33%|███▎      | 9/27 [02:01<04:11, 13.95s/it]
Epoch 6:  37%|███▋      | 10/27 [02:15<03:58, 14.03s/it]
Epoch 6:  41%|████      | 11/27 [02:30<03:45, 14.09s/it]
Epoch 6:  44%|████▍     | 12/27 [02:44<03:31, 14.12s/it]
Epoch 6:  48%|████▊     | 13/27 [02:58<03:18, 14.14s/it]
Epoch 6:  52%|█████▏    | 14/27 [03:12<03:03, 14.11s/it]
Epoch 6:  56%|█████▌    | 15/27 [03:25<02:46, 13.89s/it]
Epoch 6:  59%|█████▉    | 16/27 [03:39<02:31, 13.74s/it]
Epoch 6:  63%|██████▎   | 17/27 [03:52<02:16, 13.64s/it]
Epoch 6:  67%|██████▋   | 18/27 [04:06<02:02, 13.56s/it]
Epoch 6:  70%|███████   | 19/27 [04:19<01:48, 13.51s/it]
Epoch 6:  74%|███████▍  | 20/27 [04:32<01:34, 13.48s/it]
Epoch 6:  78%|███████▊  | 21/27 [04:46<01:20, 13.48s/it]
Epoch 6:  81%|████████▏ | 22/27 [05:00<01:08, 13.69s/it]
Epoch 6:  85%|████████▌ | 23/27 [05:14<00:55, 13.83s/it]
Epoch 6:  89%|████████▉ | 24/27 [05:28<00:41, 13.94s/it]
Epoch 6:  93%|█████████▎| 25/27 [05:42<00:27, 14.00s/it]
Epoch 6:  96%|█████████▋| 26/27 [05:57<00:14, 14.05s/it]
Epoch 6: 100%|██████████| 27/27 [06:02<00:00, 11.36s/it]
Epoch 6: 100%|██████████| 27/27 [06:02<00:00, 13.42s/it]
[Epoch 6] Training Loss: 1.6692

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:11<00:23, 11.93s/it]
Validation:  67%|██████▋   | 2/3 [00:23<00:11, 11.55s/it]
Validation: 100%|██████████| 3/3 [00:33<00:00, 11.19s/it]
Validation: 100%|██████████| 3/3 [00:33<00:00, 11.32s/it]
Accuracy: 39.67%, F1 Score: 0.2466

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.33      0.61      0.43       409
           2       0.39      0.15      0.22       105
           3       0.44      0.34      0.38       298
           4       0.47      0.54      0.50       673
           5       0.00      0.00      0.00       121
           6       0.38      0.16      0.22       410
           7       0.00      0.00      0.00       173
           8       0.38      0.60      0.47       669

    accuracy                           0.40      3000
   macro avg       0.27      0.27      0.25      3000
weighted avg       0.35      0.40      0.35      3000

Best model saved at epoch 6 with accuracy: 0.3967 and f1 score: 0.2466

Epoch 7:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 7:   4%|▎         | 1/27 [00:11<05:01, 11.58s/it]
Epoch 7:   7%|▋         | 2/27 [00:24<05:16, 12.64s/it]
Epoch 7:  11%|█         | 3/27 [00:40<05:36, 14.02s/it]
Epoch 7:  15%|█▍        | 4/27 [00:54<05:18, 13.83s/it]
Epoch 7:  19%|█▊        | 5/27 [01:07<05:03, 13.79s/it]
Epoch 7:  22%|██▏       | 6/27 [01:22<04:58, 14.20s/it]
Epoch 7:  26%|██▌       | 7/27 [01:37<04:49, 14.45s/it]
Epoch 7:  30%|██▉       | 8/27 [01:52<04:33, 14.41s/it]
Epoch 7:  33%|███▎      | 9/27 [02:06<04:17, 14.29s/it]
Epoch 7:  37%|███▋      | 10/27 [02:20<04:01, 14.22s/it]
Epoch 7:  41%|████      | 11/27 [02:34<03:46, 14.17s/it]
Epoch 7:  44%|████▍     | 12/27 [02:48<03:31, 14.13s/it]
Epoch 7:  48%|████▊     | 13/27 [03:02<03:17, 14.11s/it]
Epoch 7:  52%|█████▏    | 14/27 [03:16<03:03, 14.09s/it]
Epoch 7:  56%|█████▌    | 15/27 [03:30<02:48, 14.08s/it]
Epoch 7:  59%|█████▉    | 16/27 [03:44<02:34, 14.08s/it]
Epoch 7:  63%|██████▎   | 17/27 [03:58<02:19, 13.98s/it]
Epoch 7:  67%|██████▋   | 18/27 [04:12<02:04, 13.89s/it]
Epoch 7:  70%|███████   | 19/27 [04:25<01:50, 13.83s/it]
Epoch 7:  74%|███████▍  | 20/27 [04:39<01:36, 13.79s/it]
Epoch 7:  78%|███████▊  | 21/27 [04:53<01:22, 13.75s/it]
Epoch 7:  81%|████████▏ | 22/27 [05:06<01:08, 13.73s/it]
Epoch 7:  85%|████████▌ | 23/27 [05:20<00:54, 13.72s/it]
Epoch 7:  89%|████████▉ | 24/27 [05:34<00:41, 13.71s/it]
Epoch 7:  93%|█████████▎| 25/27 [05:47<00:27, 13.70s/it]
Epoch 7:  96%|█████████▋| 26/27 [06:01<00:13, 13.69s/it]
Epoch 7: 100%|██████████| 27/27 [06:06<00:00, 11.06s/it]
Epoch 7: 100%|██████████| 27/27 [06:06<00:00, 13.57s/it]
[Epoch 7] Training Loss: 1.6423

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:11<00:22, 11.49s/it]
Validation:  67%|██████▋   | 2/3 [00:22<00:11, 11.48s/it]
Validation: 100%|██████████| 3/3 [00:33<00:00, 11.20s/it]
Validation: 100%|██████████| 3/3 [00:33<00:00, 11.28s/it]
Accuracy: 39.97%, F1 Score: 0.2551

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.35      0.53      0.42       409
           2       0.41      0.27      0.32       105
           3       0.43      0.36      0.39       298
           4       0.42      0.65      0.51       673
           5       0.00      0.00      0.00       121
           6       0.44      0.12      0.19       410
           7       0.00      0.00      0.00       173
           8       0.39      0.53      0.45       669

    accuracy                           0.40      3000
   macro avg       0.27      0.27      0.26      3000
weighted avg       0.35      0.40      0.35      3000

Best model saved at epoch 7 with accuracy: 0.3997 and f1 score: 0.2551

Epoch 8:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 8:   4%|▎         | 1/27 [00:09<04:13,  9.74s/it]
Epoch 8:   7%|▋         | 2/27 [00:21<04:29, 10.80s/it]
Epoch 8:  11%|█         | 3/27 [00:33<04:38, 11.60s/it]
Epoch 8:  15%|█▍        | 4/27 [00:47<04:44, 12.36s/it]
Epoch 8:  19%|█▊        | 5/27 [01:00<04:40, 12.76s/it]
Epoch 8:  22%|██▏       | 6/27 [01:15<04:42, 13.44s/it]
Epoch 8:  26%|██▌       | 7/27 [01:30<04:37, 13.87s/it]
Epoch 8:  30%|██▉       | 8/27 [01:44<04:26, 14.05s/it]
Epoch 8:  33%|███▎      | 9/27 [01:58<04:11, 13.98s/it]
Epoch 8:  37%|███▋      | 10/27 [02:12<03:56, 13.94s/it]
Epoch 8:  41%|████      | 11/27 [02:26<03:42, 13.92s/it]
Epoch 8:  44%|████▍     | 12/27 [02:40<03:28, 13.90s/it]
Epoch 8:  48%|████▊     | 13/27 [02:54<03:14, 13.89s/it]
Epoch 8:  52%|█████▏    | 14/27 [03:08<03:01, 13.95s/it]
Epoch 8:  56%|█████▌    | 15/27 [03:22<02:50, 14.18s/it]
Epoch 8:  59%|█████▉    | 16/27 [03:37<02:37, 14.33s/it]
Epoch 8:  63%|██████▎   | 17/27 [03:52<02:23, 14.39s/it]
Epoch 8:  67%|██████▋   | 18/27 [04:05<02:07, 14.21s/it]
Epoch 8:  70%|███████   | 19/27 [04:21<01:56, 14.54s/it]
Epoch 8:  74%|███████▍  | 20/27 [04:36<01:43, 14.80s/it]
Epoch 8:  78%|███████▊  | 21/27 [04:51<01:28, 14.70s/it]
Epoch 8:  81%|████████▏ | 22/27 [05:05<01:13, 14.63s/it]
Epoch 8:  85%|████████▌ | 23/27 [05:19<00:58, 14.57s/it]
Epoch 8:  89%|████████▉ | 24/27 [05:33<00:42, 14.28s/it]
Epoch 8:  93%|█████████▎| 25/27 [05:47<00:28, 14.07s/it]
Epoch 8:  96%|█████████▋| 26/27 [06:00<00:13, 13.93s/it]
Epoch 8: 100%|██████████| 27/27 [06:05<00:00, 11.22s/it]
Epoch 8: 100%|██████████| 27/27 [06:05<00:00, 13.54s/it]
[Epoch 8] Training Loss: 1.6197

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:11<00:22, 11.45s/it]
Validation:  67%|██████▋   | 2/3 [00:22<00:11, 11.43s/it]
Validation: 100%|██████████| 3/3 [00:33<00:00, 11.14s/it]
Validation: 100%|██████████| 3/3 [00:33<00:00, 11.22s/it]
Accuracy: 40.83%, F1 Score: 0.2706

Detailed Report:
               precision    recall  f1-score   support

           0       1.00      0.01      0.01       142
           1       0.34      0.58      0.43       409
           2       0.42      0.29      0.34       105
           3       0.44      0.37      0.40       298
           4       0.47      0.54      0.51       673
           5       0.00      0.00      0.00       121
           6       0.47      0.18      0.26       410
           7       1.00      0.01      0.01       173
           8       0.38      0.61      0.47       669

    accuracy                           0.41      3000
   macro avg       0.50      0.29      0.27      3000
weighted avg       0.47      0.41      0.37      3000

Best model saved at epoch 8 with accuracy: 0.4083 and f1 score: 0.2706

Epoch 9:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 9:   4%|▎         | 1/27 [00:10<04:27, 10.30s/it]
Epoch 9:   7%|▋         | 2/27 [00:22<04:38, 11.14s/it]
Epoch 9:  11%|█         | 3/27 [00:34<04:43, 11.82s/it]
Epoch 9:  15%|█▍        | 4/27 [00:48<04:53, 12.74s/it]
Epoch 9:  19%|█▊        | 5/27 [01:02<04:46, 13.01s/it]
Epoch 9:  22%|██▏       | 6/27 [01:15<04:36, 13.15s/it]
Epoch 9:  26%|██▌       | 7/27 [01:28<04:20, 13.03s/it]
Epoch 9:  30%|██▉       | 8/27 [01:41<04:06, 12.95s/it]
Epoch 9:  33%|███▎      | 9/27 [01:54<03:52, 12.90s/it]
Epoch 9:  37%|███▋      | 10/27 [02:07<03:42, 13.11s/it]
Epoch 9:  41%|████      | 11/27 [02:21<03:32, 13.26s/it]
Epoch 9:  44%|████▍     | 12/27 [02:34<03:20, 13.36s/it]
Epoch 9:  48%|████▊     | 13/27 [02:48<03:07, 13.42s/it]
Epoch 9:  52%|█████▏    | 14/27 [03:01<02:55, 13.47s/it]
Epoch 9:  56%|█████▌    | 15/27 [03:15<02:41, 13.50s/it]
Epoch 9:  59%|█████▉    | 16/27 [03:29<02:28, 13.52s/it]
Epoch 9:  63%|██████▎   | 17/27 [03:42<02:15, 13.53s/it]
Epoch 9:  67%|██████▋   | 18/27 [03:56<02:01, 13.54s/it]
Epoch 9:  70%|███████   | 19/27 [04:09<01:48, 13.55s/it]
Epoch 9:  74%|███████▍  | 20/27 [04:23<01:34, 13.56s/it]
Epoch 9:  78%|███████▊  | 21/27 [04:36<01:21, 13.57s/it]
Epoch 9:  81%|████████▏ | 22/27 [04:50<01:08, 13.61s/it]
Epoch 9:  85%|████████▌ | 23/27 [05:05<00:55, 13.95s/it]
Epoch 9:  89%|████████▉ | 24/27 [05:20<00:42, 14.23s/it]
Epoch 9:  93%|█████████▎| 25/27 [05:34<00:28, 14.24s/it]
Epoch 9:  96%|█████████▋| 26/27 [05:48<00:14, 14.14s/it]
Epoch 9: 100%|██████████| 27/27 [05:53<00:00, 11.40s/it]
Epoch 9: 100%|██████████| 27/27 [05:53<00:00, 13.09s/it]
[Epoch 9] Training Loss: 1.5972

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:11<00:23, 11.71s/it]
Validation:  67%|██████▋   | 2/3 [00:23<00:11, 11.71s/it]
Validation: 100%|██████████| 3/3 [00:34<00:00, 11.42s/it]
Validation: 100%|██████████| 3/3 [00:34<00:00, 11.50s/it]
Accuracy: 40.43%, F1 Score: 0.2748

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.32      0.54      0.40       409
           2       0.48      0.29      0.36       105
           3       0.38      0.45      0.41       298
           4       0.47      0.53      0.50       673
           5       0.00      0.00      0.00       121
           6       0.48      0.25      0.33       410
           7       1.00      0.01      0.01       173
           8       0.40      0.56      0.47       669

    accuracy                           0.40      3000
   macro avg       0.39      0.29      0.27      3000
weighted avg       0.42      0.40      0.37      3000

Best model saved at epoch 9 with accuracy: 0.4043 and f1 score: 0.2748

Epoch 10:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 10:   4%|▎         | 1/27 [00:09<04:15,  9.81s/it]
Epoch 10:   7%|▋         | 2/27 [00:21<04:34, 10.99s/it]
Epoch 10:  11%|█         | 3/27 [00:34<04:43, 11.83s/it]
Epoch 10:  15%|█▍        | 4/27 [00:47<04:43, 12.32s/it]
Epoch 10:  19%|█▊        | 5/27 [01:00<04:39, 12.70s/it]
Epoch 10:  22%|██▏       | 6/27 [01:14<04:31, 12.94s/it]
Epoch 10:  26%|██▌       | 7/27 [01:28<04:24, 13.23s/it]
Epoch 10:  30%|██▉       | 8/27 [01:41<04:15, 13.43s/it]
Epoch 10:  33%|███▎      | 9/27 [01:55<04:03, 13.55s/it]
Epoch 10:  37%|███▋      | 10/27 [02:09<03:51, 13.64s/it]
Epoch 10:  41%|████      | 11/27 [02:23<03:39, 13.70s/it]
Epoch 10:  44%|████▍     | 12/27 [02:37<03:26, 13.74s/it]
Epoch 10:  48%|████▊     | 13/27 [02:51<03:14, 13.87s/it]
Epoch 10:  52%|█████▏    | 14/27 [03:05<03:02, 14.04s/it]
Epoch 10:  56%|█████▌    | 15/27 [03:20<02:49, 14.15s/it]
Epoch 10:  59%|█████▉    | 16/27 [03:34<02:36, 14.24s/it]
Epoch 10:  63%|██████▎   | 17/27 [03:49<02:22, 14.30s/it]
Epoch 10:  67%|██████▋   | 18/27 [04:03<02:09, 14.33s/it]
Epoch 10:  70%|███████   | 19/27 [04:18<01:54, 14.37s/it]
Epoch 10:  74%|███████▍  | 20/27 [04:32<01:40, 14.39s/it]
Epoch 10:  78%|███████▊  | 21/27 [04:46<01:26, 14.40s/it]
Epoch 10:  81%|████████▏ | 22/27 [05:01<01:12, 14.41s/it]
Epoch 10:  85%|████████▌ | 23/27 [05:15<00:57, 14.42s/it]
Epoch 10:  89%|████████▉ | 24/27 [05:30<00:43, 14.42s/it]
Epoch 10:  93%|█████████▎| 25/27 [05:44<00:28, 14.42s/it]
Epoch 10:  96%|█████████▋| 26/27 [05:59<00:14, 14.43s/it]
Epoch 10: 100%|██████████| 27/27 [06:04<00:00, 11.66s/it]
Epoch 10: 100%|██████████| 27/27 [06:04<00:00, 13.49s/it]
[Epoch 10] Training Loss: 1.5750

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:12<00:24, 12.13s/it]
Validation:  67%|██████▋   | 2/3 [00:24<00:12, 12.14s/it]
Validation: 100%|██████████| 3/3 [00:35<00:00, 11.53s/it]
Validation: 100%|██████████| 3/3 [00:35<00:00, 11.70s/it]
Accuracy: 41.03%, F1 Score: 0.2840

Detailed Report:
               precision    recall  f1-score   support

           0       0.25      0.01      0.01       142
           1       0.34      0.58      0.43       409
           2       0.44      0.35      0.39       105
           3       0.42      0.37      0.40       298
           4       0.47      0.54      0.50       673
           5       0.00      0.00      0.00       121
           6       0.42      0.31      0.36       410
           7       0.25      0.01      0.01       173
           8       0.41      0.53      0.46       669

    accuracy                           0.41      3000
   macro avg       0.33      0.30      0.28      3000
weighted avg       0.38      0.41      0.38      3000

Best model saved at epoch 10 with accuracy: 0.4103 and f1 score: 0.2840

Epoch 11:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 11:   4%|▎         | 1/27 [00:10<04:28, 10.32s/it]
Epoch 11:   7%|▋         | 2/27 [00:22<04:51, 11.64s/it]
Epoch 11:  11%|█         | 3/27 [00:35<04:49, 12.07s/it]
Epoch 11:  15%|█▍        | 4/27 [00:48<04:44, 12.38s/it]
Epoch 11:  19%|█▊        | 5/27 [01:02<04:44, 12.95s/it]
Epoch 11:  22%|██▏       | 6/27 [01:16<04:38, 13.28s/it]
Epoch 11:  26%|██▌       | 7/27 [01:30<04:29, 13.49s/it]
Epoch 11:  30%|██▉       | 8/27 [01:43<04:18, 13.60s/it]
Epoch 11:  33%|███▎      | 9/27 [01:57<04:02, 13.46s/it]
Epoch 11:  37%|███▋      | 10/27 [02:10<03:47, 13.38s/it]
Epoch 11:  41%|████      | 11/27 [02:23<03:33, 13.33s/it]
Epoch 11:  44%|████▍     | 12/27 [02:37<03:22, 13.53s/it]
Epoch 11:  48%|████▊     | 13/27 [02:51<03:11, 13.65s/it]
Epoch 11:  52%|█████▏    | 14/27 [03:05<02:58, 13.76s/it]
Epoch 11:  56%|█████▌    | 15/27 [03:19<02:46, 13.84s/it]
Epoch 11:  59%|█████▉    | 16/27 [03:33<02:32, 13.89s/it]
Epoch 11:  63%|██████▎   | 17/27 [03:47<02:19, 13.93s/it]
Epoch 11:  67%|██████▋   | 18/27 [04:01<02:05, 13.95s/it]
Epoch 11:  70%|███████   | 19/27 [04:15<01:52, 14.08s/it]
Epoch 11:  74%|███████▍  | 20/27 [04:30<01:40, 14.36s/it]
Epoch 11:  78%|███████▊  | 21/27 [04:45<01:27, 14.54s/it]
Epoch 11:  81%|████████▏ | 22/27 [05:00<01:12, 14.58s/it]
Epoch 11:  85%|████████▌ | 23/27 [05:14<00:57, 14.41s/it]
Epoch 11:  89%|████████▉ | 24/27 [05:28<00:42, 14.29s/it]
Epoch 11:  93%|█████████▎| 25/27 [05:42<00:28, 14.21s/it]
Epoch 11:  96%|█████████▋| 26/27 [05:56<00:14, 14.16s/it]
Epoch 11: 100%|██████████| 27/27 [06:01<00:00, 11.43s/it]
Epoch 11: 100%|██████████| 27/27 [06:01<00:00, 13.40s/it]
[Epoch 11] Training Loss: 1.5410

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:11<00:23, 11.79s/it]
Validation:  67%|██████▋   | 2/3 [00:23<00:11, 11.80s/it]
Validation: 100%|██████████| 3/3 [00:34<00:00, 11.19s/it]
Validation: 100%|██████████| 3/3 [00:34<00:00, 11.36s/it]
Accuracy: 41.47%, F1 Score: 0.2844

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.34      0.59      0.43       409
           2       0.45      0.30      0.36       105
           3       0.46      0.38      0.42       298
           4       0.45      0.55      0.49       673
           5       0.00      0.00      0.00       121
           6       0.45      0.31      0.37       410
           7       0.33      0.01      0.02       173
           8       0.42      0.54      0.47       669

    accuracy                           0.41      3000
   macro avg       0.32      0.30      0.28      3000
weighted avg       0.38      0.41      0.38      3000

Best model saved at epoch 11 with accuracy: 0.4147 and f1 score: 0.2844

Epoch 12:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 12:   4%|▎         | 1/27 [00:10<04:21, 10.04s/it]
Epoch 12:   7%|▋         | 2/27 [00:22<04:40, 11.21s/it]
Epoch 12:  11%|█         | 3/27 [00:34<04:46, 11.95s/it]
Epoch 12:  15%|█▍        | 4/27 [00:47<04:44, 12.38s/it]
Epoch 12:  19%|█▊        | 5/27 [01:01<04:40, 12.75s/it]
Epoch 12:  22%|██▏       | 6/27 [01:14<04:33, 13.02s/it]
Epoch 12:  26%|██▌       | 7/27 [01:28<04:23, 13.20s/it]
Epoch 12:  30%|██▉       | 8/27 [01:41<04:12, 13.31s/it]
Epoch 12:  33%|███▎      | 9/27 [01:55<04:00, 13.38s/it]
Epoch 12:  37%|███▋      | 10/27 [02:09<03:48, 13.43s/it]
Epoch 12:  41%|████      | 11/27 [02:22<03:35, 13.46s/it]
Epoch 12:  44%|████▍     | 12/27 [02:36<03:22, 13.48s/it]
Epoch 12:  48%|████▊     | 13/27 [02:49<03:08, 13.50s/it]
Epoch 12:  52%|█████▏    | 14/27 [03:03<02:55, 13.50s/it]
Epoch 12:  56%|█████▌    | 15/27 [03:16<02:42, 13.50s/it]
Epoch 12:  59%|█████▉    | 16/27 [03:29<02:27, 13.41s/it]
Epoch 12:  63%|██████▎   | 17/27 [03:42<02:12, 13.22s/it]
Epoch 12:  67%|██████▋   | 18/27 [03:55<01:57, 13.09s/it]
Epoch 12:  70%|███████   | 19/27 [04:08<01:44, 13.01s/it]
Epoch 12:  74%|███████▍  | 20/27 [04:21<01:31, 13.01s/it]
Epoch 12:  78%|███████▊  | 21/27 [04:34<01:18, 13.13s/it]
Epoch 12:  81%|████████▏ | 22/27 [04:48<01:06, 13.21s/it]
Epoch 12:  85%|████████▌ | 23/27 [05:01<00:53, 13.26s/it]
Epoch 12:  89%|████████▉ | 24/27 [05:14<00:39, 13.30s/it]
Epoch 12:  93%|█████████▎| 25/27 [05:28<00:26, 13.32s/it]
Epoch 12:  96%|█████████▋| 26/27 [05:41<00:13, 13.33s/it]
Epoch 12: 100%|██████████| 27/27 [05:46<00:00, 10.77s/it]
Epoch 12: 100%|██████████| 27/27 [05:46<00:00, 12.83s/it]
[Epoch 12] Training Loss: 1.5108

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:11<00:22, 11.25s/it]
Validation:  67%|██████▋   | 2/3 [00:22<00:11, 11.25s/it]
Validation: 100%|██████████| 3/3 [00:33<00:00, 10.94s/it]
Validation: 100%|██████████| 3/3 [00:33<00:00, 11.02s/it]
Accuracy: 41.03%, F1 Score: 0.2907

Detailed Report:
               precision    recall  f1-score   support

           0       0.17      0.01      0.01       142
           1       0.35      0.56      0.43       409
           2       0.33      0.42      0.37       105
           3       0.45      0.35      0.39       298
           4       0.45      0.54      0.49       673
           5       1.00      0.01      0.02       121
           6       0.43      0.36      0.39       410
           7       0.38      0.03      0.05       173
           8       0.42      0.50      0.45       669

    accuracy                           0.41      3000
   macro avg       0.44      0.31      0.29      3000
weighted avg       0.43      0.41      0.38      3000

Best model saved at epoch 12 with accuracy: 0.4103 and f1 score: 0.2907

Epoch 13:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 13:   4%|▎         | 1/27 [00:10<04:22, 10.08s/it]
Epoch 13:   7%|▋         | 2/27 [00:22<04:43, 11.32s/it]
Epoch 13:  11%|█         | 3/27 [00:35<04:56, 12.33s/it]
Epoch 13:  15%|█▍        | 4/27 [00:49<04:52, 12.72s/it]
Epoch 13:  19%|█▊        | 5/27 [01:02<04:44, 12.95s/it]
Epoch 13:  22%|██▏       | 6/27 [01:15<04:34, 13.06s/it]
Epoch 13:  26%|██▌       | 7/27 [01:29<04:27, 13.38s/it]
Epoch 13:  30%|██▉       | 8/27 [01:43<04:18, 13.60s/it]
Epoch 13:  33%|███▎      | 9/27 [01:57<04:07, 13.75s/it]
Epoch 13:  37%|███▋      | 10/27 [02:11<03:55, 13.84s/it]
Epoch 13:  41%|████      | 11/27 [02:25<03:38, 13.69s/it]
Epoch 13:  44%|████▍     | 12/27 [02:40<03:31, 14.10s/it]
Epoch 13:  48%|████▊     | 13/27 [02:54<03:17, 14.10s/it]
Epoch 13:  52%|█████▏    | 14/27 [03:08<03:03, 14.09s/it]
Epoch 13:  56%|█████▌    | 15/27 [03:21<02:46, 13.85s/it]
Epoch 13:  59%|█████▉    | 16/27 [03:35<02:30, 13.68s/it]
Epoch 13:  63%|██████▎   | 17/27 [03:48<02:15, 13.57s/it]
Epoch 13:  67%|██████▋   | 18/27 [04:01<02:01, 13.49s/it]
Epoch 13:  70%|███████   | 19/27 [04:15<01:47, 13.44s/it]
Epoch 13:  74%|███████▍  | 20/27 [04:28<01:33, 13.39s/it]
Epoch 13:  78%|███████▊  | 21/27 [04:41<01:20, 13.36s/it]
Epoch 13:  81%|████████▏ | 22/27 [04:54<01:06, 13.34s/it]
Epoch 13:  85%|████████▌ | 23/27 [05:08<00:53, 13.33s/it]
Epoch 13:  89%|████████▉ | 24/27 [05:21<00:39, 13.32s/it]
Epoch 13:  93%|█████████▎| 25/27 [05:34<00:26, 13.31s/it]
Epoch 13:  96%|█████████▋| 26/27 [05:48<00:13, 13.30s/it]
Epoch 13: 100%|██████████| 27/27 [05:52<00:00, 10.74s/it]
Epoch 13: 100%|██████████| 27/27 [05:52<00:00, 13.07s/it]
[Epoch 13] Training Loss: 1.4867

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:11<00:22, 11.20s/it]
Validation:  67%|██████▋   | 2/3 [00:22<00:11, 11.19s/it]
Validation: 100%|██████████| 3/3 [00:32<00:00, 10.88s/it]
Validation: 100%|██████████| 3/3 [00:32<00:00, 10.97s/it]
Accuracy: 40.67%, F1 Score: 0.2916

Detailed Report:
               precision    recall  f1-score   support

           0       0.14      0.01      0.01       142
           1       0.33      0.59      0.43       409
           2       0.41      0.37      0.39       105
           3       0.41      0.37      0.39       298
           4       0.46      0.54      0.50       673
           5       0.67      0.02      0.03       121
           6       0.39      0.42      0.40       410
           7       0.40      0.02      0.04       173
           8       0.43      0.43      0.43       669

    accuracy                           0.41      3000
   macro avg       0.41      0.31      0.29      3000
weighted avg       0.41      0.41      0.38      3000

Best model saved at epoch 13 with accuracy: 0.4067 and f1 score: 0.2916

Epoch 14:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 14:   4%|▎         | 1/27 [00:09<04:18,  9.93s/it]
Epoch 14:   7%|▋         | 2/27 [00:22<04:40, 11.23s/it]
Epoch 14:  11%|█         | 3/27 [00:34<04:43, 11.82s/it]
Epoch 14:  15%|█▍        | 4/27 [00:48<04:53, 12.76s/it]
Epoch 14:  19%|█▊        | 5/27 [01:02<04:50, 13.18s/it]
Epoch 14:  22%|██▏       | 6/27 [01:16<04:38, 13.25s/it]
Epoch 14:  26%|██▌       | 7/27 [01:29<04:26, 13.31s/it]
Epoch 14:  30%|██▉       | 8/27 [01:42<04:13, 13.35s/it]
Epoch 14:  33%|███▎      | 9/27 [01:56<04:00, 13.38s/it]
Epoch 14:  37%|███▋      | 10/27 [02:10<03:48, 13.47s/it]
Epoch 14:  41%|████      | 11/27 [02:24<03:38, 13.66s/it]
Epoch 14:  44%|████▍     | 12/27 [02:38<03:26, 13.79s/it]
Epoch 14:  48%|████▊     | 13/27 [02:52<03:14, 13.88s/it]
Epoch 14:  52%|█████▏    | 14/27 [03:06<03:00, 13.91s/it]
Epoch 14:  56%|█████▌    | 15/27 [03:19<02:44, 13.71s/it]
Epoch 14:  59%|█████▉    | 16/27 [03:32<02:29, 13.58s/it]
Epoch 14:  63%|██████▎   | 17/27 [03:46<02:14, 13.49s/it]
Epoch 14:  67%|██████▋   | 18/27 [03:59<02:00, 13.43s/it]
Epoch 14:  70%|███████   | 19/27 [04:12<01:47, 13.38s/it]
Epoch 14:  74%|███████▍  | 20/27 [04:25<01:33, 13.35s/it]
Epoch 14:  78%|███████▊  | 21/27 [04:39<01:19, 13.33s/it]
Epoch 14:  81%|████████▏ | 22/27 [04:52<01:06, 13.31s/it]
Epoch 14:  85%|████████▌ | 23/27 [05:05<00:53, 13.30s/it]
Epoch 14:  89%|████████▉ | 24/27 [05:19<00:39, 13.29s/it]
Epoch 14:  93%|█████████▎| 25/27 [05:32<00:26, 13.29s/it]
Epoch 14:  96%|█████████▋| 26/27 [05:45<00:13, 13.29s/it]
Epoch 14: 100%|██████████| 27/27 [05:50<00:00, 10.74s/it]
Epoch 14: 100%|██████████| 27/27 [05:50<00:00, 12.98s/it]
[Epoch 14] Training Loss: 1.4507

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:11<00:22, 11.20s/it]
Validation:  67%|██████▋   | 2/3 [00:22<00:11, 11.19s/it]
Validation: 100%|██████████| 3/3 [00:32<00:00, 10.88s/it]
Validation: 100%|██████████| 3/3 [00:32<00:00, 10.96s/it]
Accuracy: 40.67%, F1 Score: 0.2904

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.33      0.50      0.40       409
           2       0.41      0.31      0.36       105
           3       0.37      0.44      0.41       298
           4       0.45      0.55      0.49       673
           5       0.27      0.02      0.05       121
           6       0.43      0.37      0.40       410
           7       0.27      0.03      0.06       173
           8       0.43      0.48      0.45       669

    accuracy                           0.41      3000
   macro avg       0.33      0.30      0.29      3000
weighted avg       0.38      0.41      0.38      3000


Epoch 15:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 15:   4%|▎         | 1/27 [00:13<05:54, 13.62s/it]
Epoch 15:   7%|▋         | 2/27 [00:27<05:43, 13.75s/it]
Epoch 15:  11%|█         | 3/27 [00:41<05:30, 13.78s/it]
Epoch 15:  15%|█▍        | 4/27 [00:55<05:17, 13.80s/it]
Epoch 15:  19%|█▊        | 5/27 [01:08<05:03, 13.81s/it]
Epoch 15:  22%|██▏       | 6/27 [01:22<04:50, 13.82s/it]
Epoch 15:  26%|██▌       | 7/27 [01:36<04:36, 13.81s/it]
Epoch 15:  30%|██▉       | 8/27 [01:50<04:22, 13.81s/it]
Epoch 15:  33%|███▎      | 9/27 [02:04<04:08, 13.81s/it]
Epoch 15:  37%|███▋      | 10/27 [02:18<03:54, 13.81s/it]
Epoch 15:  41%|████      | 11/27 [02:31<03:41, 13.81s/it]
Epoch 15:  44%|████▍     | 12/27 [02:45<03:27, 13.81s/it]
Epoch 15:  48%|████▊     | 13/27 [02:59<03:13, 13.81s/it]
Epoch 15:  52%|█████▏    | 14/27 [03:13<02:59, 13.80s/it]
Epoch 15:  56%|█████▌    | 15/27 [03:26<02:42, 13.57s/it]
Epoch 15:  59%|█████▉    | 16/27 [03:39<02:27, 13.40s/it]
Epoch 15:  63%|██████▎   | 17/27 [03:52<02:12, 13.29s/it]
Epoch 15:  67%|██████▋   | 18/27 [04:05<01:58, 13.22s/it]
Epoch 15:  70%|███████   | 19/27 [04:18<01:45, 13.17s/it]
Epoch 15:  74%|███████▍  | 20/27 [04:31<01:31, 13.13s/it]
Epoch 15:  78%|███████▊  | 21/27 [04:44<01:18, 13.10s/it]
Epoch 15:  81%|████████▏ | 22/27 [04:57<01:05, 13.08s/it]
Epoch 15:  85%|████████▌ | 23/27 [05:10<00:52, 13.08s/it]
Epoch 15:  89%|████████▉ | 24/27 [05:23<00:39, 13.08s/it]
Epoch 15:  93%|█████████▎| 25/27 [05:38<00:27, 13.52s/it]
Epoch 15:  96%|█████████▋| 26/27 [05:52<00:13, 13.78s/it]
Epoch 15: 100%|██████████| 27/27 [05:57<00:00, 11.21s/it]
Epoch 15: 100%|██████████| 27/27 [05:57<00:00, 13.25s/it]
[Epoch 15] Training Loss: 1.4123

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:12<00:24, 12.11s/it]
Validation:  67%|██████▋   | 2/3 [00:23<00:11, 11.70s/it]
Validation: 100%|██████████| 3/3 [00:34<00:00, 11.29s/it]
Validation: 100%|██████████| 3/3 [00:34<00:00, 11.44s/it]
Accuracy: 40.33%, F1 Score: 0.2998

Detailed Report:
               precision    recall  f1-score   support

           0       0.20      0.01      0.03       142
           1       0.37      0.47      0.41       409
           2       0.39      0.33      0.36       105
           3       0.42      0.33      0.37       298
           4       0.42      0.60      0.49       673
           5       0.38      0.08      0.14       121
           6       0.40      0.40      0.40       410
           7       0.28      0.04      0.07       173
           8       0.42      0.45      0.43       669

    accuracy                           0.40      3000
   macro avg       0.36      0.30      0.30      3000
weighted avg       0.39      0.40      0.38      3000

Best model saved at epoch 15 with accuracy: 0.4033 and f1 score: 0.2998

Epoch 16:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 16:   4%|▎         | 1/27 [00:10<04:21, 10.05s/it]
Epoch 16:   7%|▋         | 2/27 [00:22<04:39, 11.17s/it]
Epoch 16:  11%|█         | 3/27 [00:34<04:47, 11.96s/it]
Epoch 16:  15%|█▍        | 4/27 [00:48<04:52, 12.70s/it]
Epoch 16:  19%|█▊        | 5/27 [01:02<04:48, 13.09s/it]
Epoch 16:  22%|██▏       | 6/27 [01:16<04:41, 13.41s/it]
Epoch 16:  26%|██▌       | 7/27 [01:31<04:36, 13.84s/it]
Epoch 16:  30%|██▉       | 8/27 [01:46<04:31, 14.27s/it]
Epoch 16:  33%|███▎      | 9/27 [02:02<04:27, 14.87s/it]
Epoch 16:  37%|███▋      | 10/27 [02:18<04:18, 15.20s/it]
Epoch 16:  41%|████      | 11/27 [02:33<04:02, 15.17s/it]
Epoch 16:  44%|████▍     | 12/27 [02:48<03:47, 15.14s/it]
Epoch 16:  48%|████▊     | 13/27 [03:03<03:29, 14.99s/it]
Epoch 16:  52%|█████▏    | 14/27 [03:19<03:17, 15.22s/it]
Epoch 16:  56%|█████▌    | 15/27 [03:34<03:04, 15.39s/it]
Epoch 16:  59%|█████▉    | 16/27 [03:49<02:47, 15.20s/it]
Epoch 16:  63%|██████▎   | 17/27 [04:04<02:30, 15.08s/it]
Epoch 16:  67%|██████▋   | 18/27 [04:20<02:18, 15.34s/it]
Epoch 16:  70%|███████   | 19/27 [04:36<02:05, 15.64s/it]
Epoch 16:  74%|███████▍  | 20/27 [04:52<01:50, 15.81s/it]
Epoch 16:  78%|███████▊  | 21/27 [05:08<01:33, 15.63s/it]
Epoch 16:  81%|████████▏ | 22/27 [05:23<01:17, 15.51s/it]
Epoch 16:  85%|████████▌ | 23/27 [05:39<01:02, 15.55s/it]
Epoch 16:  89%|████████▉ | 24/27 [05:54<00:46, 15.66s/it]
Epoch 16:  93%|█████████▎| 25/27 [06:10<00:31, 15.72s/it]
Epoch 16:  96%|█████████▋| 26/27 [06:26<00:15, 15.77s/it]
Epoch 16: 100%|██████████| 27/27 [06:32<00:00, 12.74s/it]
Epoch 16: 100%|██████████| 27/27 [06:32<00:00, 14.53s/it]
[Epoch 16] Training Loss: 1.3801

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:13<00:26, 13.35s/it]
Validation:  67%|██████▋   | 2/3 [00:26<00:13, 13.36s/it]
Validation: 100%|██████████| 3/3 [00:39<00:00, 13.07s/it]
Validation: 100%|██████████| 3/3 [00:39<00:00, 13.14s/it]
Accuracy: 39.83%, F1 Score: 0.3015

Detailed Report:
               precision    recall  f1-score   support

           0       0.05      0.01      0.01       142
           1       0.36      0.49      0.42       409
           2       0.42      0.32      0.37       105
           3       0.39      0.38      0.39       298
           4       0.49      0.45      0.47       673
           5       0.28      0.08      0.13       121
           6       0.35      0.46      0.40       410
           7       0.25      0.05      0.09       173
           8       0.40      0.49      0.44       669

    accuracy                           0.40      3000
   macro avg       0.33      0.31      0.30      3000
weighted avg       0.38      0.40      0.38      3000

Best model saved at epoch 16 with accuracy: 0.3983 and f1 score: 0.3015

Epoch 17:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 17:   4%|▎         | 1/27 [00:11<04:54, 11.34s/it]
Epoch 17:   7%|▋         | 2/27 [00:23<04:48, 11.54s/it]
Epoch 17:  11%|█         | 3/27 [00:34<04:41, 11.73s/it]
Epoch 17:  15%|█▍        | 4/27 [00:48<04:49, 12.59s/it]
Epoch 17:  19%|█▊        | 5/27 [01:04<04:57, 13.52s/it]
Epoch 17:  22%|██▏       | 6/27 [01:19<05:00, 14.30s/it]
Epoch 17:  26%|██▌       | 7/27 [01:35<04:57, 14.86s/it]
Epoch 17:  30%|██▉       | 8/27 [01:51<04:48, 15.20s/it]
Epoch 17:  33%|███▎      | 9/27 [02:07<04:37, 15.43s/it]
Epoch 17:  37%|███▋      | 10/27 [02:22<04:19, 15.26s/it]
Epoch 17:  41%|████      | 11/27 [02:37<04:02, 15.16s/it]
Epoch 17:  44%|████▍     | 12/27 [02:52<03:48, 15.23s/it]
Epoch 17:  48%|████▊     | 13/27 [03:09<03:36, 15.48s/it]
Epoch 17:  52%|█████▏    | 14/27 [03:24<03:22, 15.61s/it]
Epoch 17:  56%|█████▌    | 15/27 [03:39<03:05, 15.42s/it]
Epoch 17:  59%|█████▉    | 16/27 [03:56<02:54, 15.88s/it]
Epoch 17:  63%|██████▎   | 17/27 [04:14<02:42, 16.28s/it]
Epoch 17:  67%|██████▋   | 18/27 [04:30<02:26, 16.29s/it]
Epoch 17:  70%|███████   | 19/27 [04:46<02:09, 16.18s/it]
Epoch 17:  74%|███████▍  | 20/27 [05:02<01:52, 16.11s/it]
Epoch 17:  78%|███████▊  | 21/27 [05:18<01:36, 16.05s/it]
Epoch 17:  81%|████████▏ | 22/27 [05:33<01:18, 15.71s/it]
Epoch 17:  85%|████████▌ | 23/27 [05:48<01:01, 15.48s/it]
Epoch 17:  89%|████████▉ | 24/27 [06:02<00:45, 15.31s/it]
Epoch 17:  93%|█████████▎| 25/27 [06:17<00:30, 15.20s/it]
Epoch 17:  96%|█████████▋| 26/27 [06:32<00:15, 15.11s/it]
Epoch 17: 100%|██████████| 27/27 [06:38<00:00, 12.19s/it]
Epoch 17: 100%|██████████| 27/27 [06:38<00:00, 14.75s/it]
[Epoch 17] Training Loss: 1.3307

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:12<00:25, 12.54s/it]
Validation:  67%|██████▋   | 2/3 [00:25<00:12, 12.55s/it]
Validation: 100%|██████████| 3/3 [00:36<00:00, 12.25s/it]
Validation: 100%|██████████| 3/3 [00:36<00:00, 12.33s/it]
Accuracy: 39.73%, F1 Score: 0.2975

Detailed Report:
               precision    recall  f1-score   support

           0       0.04      0.01      0.01       142
           1       0.33      0.54      0.41       409
           2       0.37      0.40      0.38       105
           3       0.42      0.32      0.36       298
           4       0.46      0.49      0.47       673
           5       0.26      0.07      0.12       121
           6       0.41      0.35      0.38       410
           7       0.16      0.05      0.08       173
           8       0.43      0.51      0.46       669

    accuracy                           0.40      3000
   macro avg       0.32      0.30      0.30      3000
weighted avg       0.37      0.40      0.38      3000


Epoch 18:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 18:   4%|▎         | 1/27 [00:15<06:35, 15.21s/it]
Epoch 18:   7%|▋         | 2/27 [00:31<06:28, 15.55s/it]
Epoch 18:  11%|█         | 3/27 [00:46<06:15, 15.66s/it]
Epoch 18:  15%|█▍        | 4/27 [01:02<06:01, 15.70s/it]
Epoch 18:  19%|█▊        | 5/27 [01:18<05:45, 15.72s/it]
Epoch 18:  22%|██▏       | 6/27 [01:34<05:30, 15.74s/it]
Epoch 18:  26%|██▌       | 7/27 [01:49<05:14, 15.70s/it]
Epoch 18:  30%|██▉       | 8/27 [02:06<05:03, 15.97s/it]
Epoch 18:  33%|███▎      | 9/27 [02:22<04:50, 16.12s/it]
Epoch 18:  37%|███▋      | 10/27 [02:39<04:36, 16.24s/it]
Epoch 18:  41%|████      | 11/27 [02:55<04:20, 16.31s/it]
Epoch 18:  44%|████▍     | 12/27 [03:11<04:04, 16.29s/it]
Epoch 18:  48%|████▊     | 13/27 [03:26<03:39, 15.69s/it]
Epoch 18:  52%|█████▏    | 14/27 [03:40<03:18, 15.29s/it]
Epoch 18:  56%|█████▌    | 15/27 [03:54<03:00, 15.01s/it]
Epoch 18:  59%|█████▉    | 16/27 [04:09<02:44, 15.00s/it]
Epoch 18:  63%|██████▎   | 17/27 [04:25<02:32, 15.25s/it]
Epoch 18:  67%|██████▋   | 18/27 [04:39<02:13, 14.80s/it]
Epoch 18:  70%|███████   | 19/27 [04:53<01:55, 14.49s/it]
Epoch 18:  74%|███████▍  | 20/27 [05:07<01:39, 14.28s/it]
Epoch 18:  78%|███████▊  | 21/27 [05:20<01:24, 14.13s/it]
Epoch 18:  81%|████████▏ | 22/27 [05:34<01:10, 14.03s/it]
Epoch 18:  85%|████████▌ | 23/27 [05:48<00:55, 13.95s/it]
Epoch 18:  89%|████████▉ | 24/27 [06:02<00:41, 13.90s/it]
Epoch 18:  93%|█████████▎| 25/27 [06:15<00:27, 13.87s/it]
Epoch 18:  96%|█████████▋| 26/27 [06:29<00:13, 13.75s/it]
Epoch 18: 100%|██████████| 27/27 [06:34<00:00, 11.02s/it]
Epoch 18: 100%|██████████| 27/27 [06:34<00:00, 14.60s/it]
[Epoch 18] Training Loss: 1.2972

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:10<00:21, 10.95s/it]
Validation:  67%|██████▋   | 2/3 [00:21<00:10, 10.61s/it]
Validation: 100%|██████████| 3/3 [00:31<00:00, 10.21s/it]
Validation: 100%|██████████| 3/3 [00:31<00:00, 10.35s/it]
Accuracy: 39.73%, F1 Score: 0.2974

Detailed Report:
               precision    recall  f1-score   support

           0       0.18      0.02      0.04       142
           1       0.36      0.46      0.41       409
           2       0.46      0.25      0.32       105
           3       0.40      0.38      0.39       298
           4       0.45      0.52      0.48       673
           5       0.26      0.09      0.13       121
           6       0.37      0.40      0.38       410
           7       0.28      0.05      0.09       173
           8       0.40      0.50      0.44       669

    accuracy                           0.40      3000
   macro avg       0.35      0.30      0.30      3000
weighted avg       0.38      0.40      0.38      3000


Epoch 19:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 19:   4%|▎         | 1/27 [00:12<05:20, 12.32s/it]
Epoch 19:   7%|▋         | 2/27 [00:24<05:08, 12.32s/it]
Epoch 19:  11%|█         | 3/27 [00:36<04:55, 12.32s/it]
Epoch 19:  15%|█▍        | 4/27 [00:49<04:43, 12.31s/it]
Epoch 19:  19%|█▊        | 5/27 [01:01<04:30, 12.32s/it]
Epoch 19:  22%|██▏       | 6/27 [01:13<04:18, 12.32s/it]
Epoch 19:  26%|██▌       | 7/27 [01:26<04:06, 12.32s/it]
Epoch 19:  30%|██▉       | 8/27 [01:38<03:53, 12.31s/it]
Epoch 19:  33%|███▎      | 9/27 [01:50<03:41, 12.31s/it]
Epoch 19:  37%|███▋      | 10/27 [02:03<03:29, 12.31s/it]
Epoch 19:  41%|████      | 11/27 [02:15<03:17, 12.32s/it]
Epoch 19:  44%|████▍     | 12/27 [02:27<03:04, 12.32s/it]
Epoch 19:  48%|████▊     | 13/27 [02:38<02:47, 11.98s/it]
Epoch 19:  52%|█████▏    | 14/27 [02:52<02:41, 12.46s/it]
Epoch 19:  56%|█████▌    | 15/27 [03:05<02:31, 12.65s/it]
Epoch 19:  59%|█████▉    | 16/27 [03:18<02:20, 12.78s/it]
Epoch 19:  63%|██████▎   | 17/27 [03:31<02:08, 12.88s/it]
Epoch 19:  67%|██████▋   | 18/27 [03:44<01:56, 12.94s/it]
Epoch 19:  70%|███████   | 19/27 [03:58<01:43, 12.98s/it]
Epoch 19:  74%|███████▍  | 20/27 [04:10<01:30, 12.94s/it]
Epoch 19:  78%|███████▊  | 21/27 [04:21<01:14, 12.34s/it]
Epoch 19:  81%|████████▏ | 22/27 [04:32<00:59, 11.87s/it]
Epoch 19:  85%|████████▌ | 23/27 [04:43<00:46, 11.64s/it]
Epoch 19:  89%|████████▉ | 24/27 [04:55<00:35, 11.79s/it]
Epoch 19:  93%|█████████▎| 25/27 [05:08<00:24, 12.03s/it]
Epoch 19:  96%|█████████▋| 26/27 [05:21<00:12, 12.31s/it]
Epoch 19: 100%|██████████| 27/27 [05:26<00:00, 10.02s/it]
Epoch 19: 100%|██████████| 27/27 [05:26<00:00, 12.08s/it]
[Epoch 19] Training Loss: 1.2514

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:11<00:22, 11.31s/it]
Validation:  67%|██████▋   | 2/3 [00:22<00:11, 11.30s/it]
Validation: 100%|██████████| 3/3 [00:33<00:00, 10.98s/it]
Validation: 100%|██████████| 3/3 [00:33<00:00, 11.07s/it]
Accuracy: 39.33%, F1 Score: 0.2923

Detailed Report:
               precision    recall  f1-score   support

           0       0.12      0.02      0.04       142
           1       0.36      0.44      0.39       409
           2       0.40      0.23      0.29       105
           3       0.39      0.43      0.41       298
           4       0.46      0.47      0.46       673
           5       0.21      0.09      0.13       121
           6       0.39      0.35      0.37       410
           7       0.22      0.05      0.08       173
           8       0.39      0.55      0.46       669

    accuracy                           0.39      3000
   macro avg       0.33      0.29      0.29      3000
weighted avg       0.37      0.39      0.37      3000


Epoch 20:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 20:   4%|▎         | 1/27 [00:13<05:48, 13.41s/it]
Epoch 20:   7%|▋         | 2/27 [00:26<05:35, 13.41s/it]
Epoch 20:  11%|█         | 3/27 [00:40<05:21, 13.41s/it]
Epoch 20:  15%|█▍        | 4/27 [00:53<05:08, 13.41s/it]
Epoch 20:  19%|█▊        | 5/27 [01:07<04:55, 13.42s/it]
Epoch 20:  22%|██▏       | 6/27 [01:20<04:41, 13.42s/it]
Epoch 20:  26%|██▌       | 7/27 [01:33<04:28, 13.42s/it]
Epoch 20:  30%|██▉       | 8/27 [01:47<04:14, 13.41s/it]
Epoch 20:  33%|███▎      | 9/27 [02:00<04:01, 13.41s/it]
Epoch 20:  37%|███▋      | 10/27 [02:14<03:47, 13.40s/it]
Epoch 20:  41%|████      | 11/27 [02:27<03:34, 13.40s/it]
Epoch 20:  44%|████▍     | 12/27 [02:40<03:20, 13.40s/it]
Epoch 20:  48%|████▊     | 13/27 [02:54<03:07, 13.40s/it]
Epoch 20:  52%|█████▏    | 14/27 [03:07<02:54, 13.40s/it]
Epoch 20:  56%|█████▌    | 15/27 [03:21<02:40, 13.41s/it]
Epoch 20:  59%|█████▉    | 16/27 [03:34<02:27, 13.41s/it]
Epoch 20:  63%|██████▎   | 17/27 [03:47<02:14, 13.41s/it]
Epoch 20:  67%|██████▋   | 18/27 [04:01<02:00, 13.42s/it]
Epoch 20:  70%|███████   | 19/27 [04:14<01:47, 13.42s/it]
Epoch 20:  74%|███████▍  | 20/27 [04:28<01:33, 13.43s/it]
Epoch 20:  78%|███████▊  | 21/27 [04:41<01:20, 13.41s/it]
Epoch 20:  81%|████████▏ | 22/27 [04:55<01:08, 13.61s/it]
Epoch 20:  85%|████████▌ | 23/27 [05:09<00:54, 13.74s/it]
Epoch 20:  89%|████████▉ | 24/27 [05:23<00:41, 13.85s/it]
Epoch 20:  93%|█████████▎| 25/27 [05:37<00:27, 13.91s/it]
Epoch 20:  96%|█████████▋| 26/27 [05:51<00:13, 13.95s/it]
Epoch 20: 100%|██████████| 27/27 [05:57<00:00, 11.29s/it]
Epoch 20: 100%|██████████| 27/27 [05:57<00:00, 13.22s/it]
[Epoch 20] Training Loss: 1.2124

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:11<00:23, 11.80s/it]
Validation:  67%|██████▋   | 2/3 [00:23<00:11, 11.53s/it]
Validation: 100%|██████████| 3/3 [00:33<00:00, 11.05s/it]
Validation: 100%|██████████| 3/3 [00:33<00:00, 11.20s/it]
Accuracy: 37.10%, F1 Score: 0.2927

Detailed Report:
               precision    recall  f1-score   support

           0       0.06      0.02      0.03       142
           1       0.34      0.49      0.40       409
           2       0.28      0.46      0.35       105
           3       0.37      0.38      0.37       298
           4       0.45      0.41      0.43       673
           5       0.17      0.12      0.14       121
           6       0.38      0.38      0.38       410
           7       0.15      0.08      0.10       173
           8       0.42      0.43      0.43       669

    accuracy                           0.37      3000
   macro avg       0.29      0.31      0.29      3000
weighted avg       0.36      0.37      0.36      3000


Epoch 21:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 21:   4%|▎         | 1/27 [00:13<05:40, 13.11s/it]
Epoch 21:   7%|▋         | 2/27 [00:27<05:42, 13.70s/it]
Epoch 21:  11%|█         | 3/27 [00:41<05:32, 13.85s/it]
Epoch 21:  15%|█▍        | 4/27 [00:54<05:13, 13.64s/it]
Epoch 21:  19%|█▊        | 5/27 [01:07<04:57, 13.53s/it]
Epoch 21:  22%|██▏       | 6/27 [01:21<04:42, 13.47s/it]
Epoch 21:  26%|██▌       | 7/27 [01:34<04:27, 13.40s/it]
Epoch 21:  30%|██▉       | 8/27 [01:49<04:23, 13.87s/it]
Epoch 21:  33%|███▎      | 9/27 [02:02<04:07, 13.75s/it]
Epoch 21:  37%|███▋      | 10/27 [02:16<03:52, 13.67s/it]
Epoch 21:  41%|████      | 11/27 [02:29<03:37, 13.61s/it]
Epoch 21:  44%|████▍     | 12/27 [02:43<03:23, 13.58s/it]
Epoch 21:  48%|████▊     | 13/27 [02:56<03:09, 13.56s/it]
Epoch 21:  52%|█████▏    | 14/27 [03:10<02:56, 13.54s/it]
Epoch 21:  56%|█████▌    | 15/27 [03:23<02:42, 13.53s/it]
Epoch 21:  59%|█████▉    | 16/27 [03:37<02:30, 13.64s/it]
Epoch 21:  63%|██████▎   | 17/27 [03:51<02:17, 13.75s/it]
Epoch 21:  67%|██████▋   | 18/27 [04:05<02:04, 13.84s/it]
Epoch 21:  70%|███████   | 19/27 [04:19<01:51, 13.89s/it]
Epoch 21:  74%|███████▍  | 20/27 [04:33<01:37, 13.95s/it]
Epoch 21:  78%|███████▊  | 21/27 [04:49<01:26, 14.41s/it]
Epoch 21:  81%|████████▏ | 22/27 [05:03<01:12, 14.40s/it]
Epoch 21:  85%|████████▌ | 23/27 [05:16<00:55, 13.96s/it]
Epoch 21:  89%|████████▉ | 24/27 [05:30<00:41, 13.93s/it]
Epoch 21:  93%|█████████▎| 25/27 [05:44<00:27, 13.91s/it]
Epoch 21:  96%|█████████▋| 26/27 [05:58<00:13, 13.88s/it]
Epoch 21: 100%|██████████| 27/27 [06:03<00:00, 11.22s/it]
Epoch 21: 100%|██████████| 27/27 [06:03<00:00, 13.45s/it]
[Epoch 21] Training Loss: 1.1659

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:11<00:23, 11.65s/it]
Validation:  67%|██████▋   | 2/3 [00:23<00:11, 11.65s/it]
Validation: 100%|██████████| 3/3 [00:34<00:00, 11.38s/it]
Validation: 100%|██████████| 3/3 [00:34<00:00, 11.45s/it]
Accuracy: 38.20%, F1 Score: 0.2869

Detailed Report:
               precision    recall  f1-score   support

           0       0.10      0.02      0.03       142
           1       0.36      0.45      0.40       409
           2       0.39      0.23      0.29       105
           3       0.38      0.34      0.36       298
           4       0.42      0.50      0.46       673
           5       0.20      0.10      0.13       121
           6       0.38      0.34      0.36       410
           7       0.19      0.08      0.11       173
           8       0.40      0.50      0.44       669

    accuracy                           0.38      3000
   macro avg       0.31      0.28      0.29      3000
weighted avg       0.36      0.38      0.36      3000

Early stopping at epoch 21

----- Starting Evaluation on Test Set -----


Test:   0%|          | 0/8 [00:00<?, ?it/s]
Test:  12%|█▎        | 1/8 [00:07<00:50,  7.20s/it]
Test:  25%|██▌       | 2/8 [00:15<00:47,  7.84s/it]
Test:  38%|███▊      | 3/8 [00:24<00:42,  8.47s/it]
Test:  50%|█████     | 4/8 [00:35<00:36,  9.22s/it]
Test:  62%|██████▎   | 5/8 [00:46<00:30, 10.00s/it]
Test:  75%|███████▌  | 6/8 [00:58<00:21, 10.76s/it]
Test:  88%|████████▊ | 7/8 [01:10<00:11, 11.08s/it]
Test: 100%|██████████| 8/8 [01:14<00:00,  8.72s/it]
Test: 100%|██████████| 8/8 [01:14<00:00,  9.26s/it]
Accuracy: 38.32%, F1 Score: 0.2849

Detailed Report:
               precision    recall  f1-score   support

           0       0.22      0.03      0.06       354
           1       0.35      0.48      0.41      1023
           2       0.32      0.26      0.29       263
           3       0.42      0.45      0.43       745
           4       0.46      0.41      0.44      1682
           5       0.22      0.06      0.09       301
           6       0.33      0.41      0.36      1025
           7       0.15      0.03      0.05       434
           8       0.39      0.49      0.44      1673

    accuracy                           0.38      7500
   macro avg       0.32      0.29      0.28      7500
weighted avg       0.36      0.38      0.36      7500

