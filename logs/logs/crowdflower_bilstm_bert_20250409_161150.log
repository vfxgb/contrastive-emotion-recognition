2025-04-09 16:12:07.194330: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-09 16:12:07.299769: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
[Main] Loading and processing CrowdFlower dataset...
[Main] Dataset already preprocessed. Skipping...
[Main] Done.
2025-04-09 16:12:22.897105: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-09 16:12:22.985488: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.

 🌟🌟 Model Configuration : {'name': 'bilstm_bert', 'bert_model_name': 'bert-large-uncased', 'hidden_dim': 256, 'dropout_rate': 0.3, 'lstm_layers': 1, 'num_epochs': 30, 'learning_rate': 0.001, 'batch_size': 1024, 'finetune_batch_size': 32, 'device': device(type='cuda'), 'model_save_path': 'results/bilstm_bert/bilstm_bert.pt', 'isear_finetune_save_path': 'results/bilstm_bert/isear_finetune_bilstm_bert.pt', 'wassa21_finetune_save_path': 'results/bilstm_bert/wassa21_finetune_bilstm_bert.pt'}, Dataset : CROWDFLOWER
Using device : cuda
Loading training data...
[Split] Train size: 26998, Test size: 3000
Number of samples in test_ds: 7500
Number of samples in train_ds: 26998
Number of samples in val_ds: 3000
Batch size:  1024

Epoch 1:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 1:   4%|▎         | 1/27 [00:07<03:26,  7.95s/it]
Epoch 1:   7%|▋         | 2/27 [00:15<03:16,  7.87s/it]
Epoch 1:  11%|█         | 3/27 [00:23<03:08,  7.85s/it]
Epoch 1:  15%|█▍        | 4/27 [00:31<03:00,  7.85s/it]
Epoch 1:  19%|█▊        | 5/27 [00:39<02:52,  7.86s/it]
Epoch 1:  22%|██▏       | 6/27 [00:47<02:45,  7.87s/it]
Epoch 1:  26%|██▌       | 7/27 [00:55<02:37,  7.87s/it]
Epoch 1:  30%|██▉       | 8/27 [01:02<02:29,  7.88s/it]
Epoch 1:  33%|███▎      | 9/27 [01:10<02:21,  7.88s/it]
Epoch 1:  37%|███▋      | 10/27 [01:18<02:14,  7.88s/it]
Epoch 1:  41%|████      | 11/27 [01:26<02:06,  7.89s/it]
Epoch 1:  44%|████▍     | 12/27 [01:34<01:59,  7.96s/it]
Epoch 1:  48%|████▊     | 13/27 [01:42<01:51,  7.93s/it]
Epoch 1:  52%|█████▏    | 14/27 [01:50<01:42,  7.92s/it]
Epoch 1:  56%|█████▌    | 15/27 [01:58<01:34,  7.90s/it]
Epoch 1:  59%|█████▉    | 16/27 [02:06<01:26,  7.89s/it]
Epoch 1:  63%|██████▎   | 17/27 [02:14<01:18,  7.88s/it]
Epoch 1:  67%|██████▋   | 18/27 [02:21<01:10,  7.88s/it]
Epoch 1:  70%|███████   | 19/27 [02:29<01:03,  7.88s/it]
Epoch 1:  74%|███████▍  | 20/27 [02:37<00:55,  7.87s/it]
Epoch 1:  78%|███████▊  | 21/27 [02:45<00:47,  7.87s/it]
Epoch 1:  81%|████████▏ | 22/27 [02:53<00:39,  7.86s/it]
Epoch 1:  85%|████████▌ | 23/27 [03:01<00:31,  7.86s/it]
Epoch 1:  89%|████████▉ | 24/27 [03:09<00:23,  7.86s/it]
Epoch 1:  93%|█████████▎| 25/27 [03:16<00:15,  7.85s/it]
Epoch 1:  96%|█████████▋| 26/27 [03:24<00:07,  7.85s/it]
Epoch 1: 100%|██████████| 27/27 [03:27<00:00,  6.37s/it]
Epoch 1: 100%|██████████| 27/27 [03:27<00:00,  7.69s/it]
[Epoch 1] Training Loss: 1.9360

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:06<00:13,  6.55s/it]
Validation:  67%|██████▋   | 2/3 [00:13<00:06,  6.55s/it]
Validation: 100%|██████████| 3/3 [00:19<00:00,  6.37s/it]
Validation: 100%|██████████| 3/3 [00:19<00:00,  6.42s/it]
Accuracy: 33.17%, F1 Score: 0.1354

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.28      0.77      0.41       409
           2       0.00      0.00      0.00       105
           3       0.00      0.00      0.00       298
           4       0.46      0.28      0.35       673
           5       0.00      0.00      0.00       121
           6       0.00      0.00      0.00       410
           7       0.00      0.00      0.00       173
           8       0.34      0.73      0.46       669

    accuracy                           0.33      3000
   macro avg       0.12      0.20      0.14      3000
weighted avg       0.22      0.33      0.24      3000

Best model saved at epoch 1 with accuracy: 0.3317 and f1 score: 0.1354

Epoch 2:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 2:   4%|▎         | 1/27 [00:07<03:23,  7.82s/it]
Epoch 2:   7%|▋         | 2/27 [00:15<03:15,  7.82s/it]
Epoch 2:  11%|█         | 3/27 [00:23<03:07,  7.83s/it]
Epoch 2:  15%|█▍        | 4/27 [00:31<03:00,  7.83s/it]
Epoch 2:  19%|█▊        | 5/27 [00:39<02:52,  7.84s/it]
Epoch 2:  22%|██▏       | 6/27 [00:47<02:44,  7.85s/it]
Epoch 2:  26%|██▌       | 7/27 [00:54<02:37,  7.86s/it]
Epoch 2:  30%|██▉       | 8/27 [01:02<02:29,  7.86s/it]
Epoch 2:  33%|███▎      | 9/27 [01:10<02:21,  7.87s/it]
Epoch 2:  37%|███▋      | 10/27 [01:18<02:13,  7.87s/it]
Epoch 2:  41%|████      | 11/27 [01:26<02:05,  7.87s/it]
Epoch 2:  44%|████▍     | 12/27 [01:34<01:58,  7.88s/it]
Epoch 2:  48%|████▊     | 13/27 [01:42<01:50,  7.87s/it]
Epoch 2:  52%|█████▏    | 14/27 [01:50<01:42,  7.88s/it]
Epoch 2:  56%|█████▌    | 15/27 [01:57<01:34,  7.88s/it]
Epoch 2:  59%|█████▉    | 16/27 [02:05<01:26,  7.87s/it]
Epoch 2:  63%|██████▎   | 17/27 [02:13<01:18,  7.87s/it]
Epoch 2:  67%|██████▋   | 18/27 [02:21<01:10,  7.87s/it]
Epoch 2:  70%|███████   | 19/27 [02:29<01:02,  7.87s/it]
Epoch 2:  74%|███████▍  | 20/27 [02:37<00:55,  7.87s/it]
Epoch 2:  78%|███████▊  | 21/27 [02:45<00:47,  7.86s/it]
Epoch 2:  81%|████████▏ | 22/27 [02:52<00:39,  7.86s/it]
Epoch 2:  85%|████████▌ | 23/27 [03:00<00:31,  7.86s/it]
Epoch 2:  89%|████████▉ | 24/27 [03:08<00:23,  7.86s/it]
Epoch 2:  93%|█████████▎| 25/27 [03:16<00:15,  7.85s/it]
Epoch 2:  96%|█████████▋| 26/27 [03:24<00:07,  7.86s/it]
Epoch 2: 100%|██████████| 27/27 [03:27<00:00,  6.36s/it]
Epoch 2: 100%|██████████| 27/27 [03:27<00:00,  7.68s/it]
[Epoch 2] Training Loss: 1.7639

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:06<00:13,  6.54s/it]
Validation:  67%|██████▋   | 2/3 [00:13<00:06,  6.55s/it]
Validation: 100%|██████████| 3/3 [00:19<00:00,  6.38s/it]
Validation: 100%|██████████| 3/3 [00:19<00:00,  6.43s/it]
Accuracy: 34.20%, F1 Score: 0.2045

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.34      0.43      0.38       409
           2       0.00      0.00      0.00       105
           3       0.39      0.29      0.33       298
           4       0.43      0.49      0.46       673
           5       0.00      0.00      0.00       121
           6       0.28      0.64      0.39       410
           7       0.00      0.00      0.00       173
           8       0.30      0.26      0.28       669

    accuracy                           0.34      3000
   macro avg       0.19      0.23      0.20      3000
weighted avg       0.29      0.34      0.30      3000

Best model saved at epoch 2 with accuracy: 0.3420 and f1 score: 0.2045

Epoch 3:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 3:   4%|▎         | 1/27 [00:07<03:23,  7.81s/it]
Epoch 3:   7%|▋         | 2/27 [00:15<03:15,  7.82s/it]
Epoch 3:  11%|█         | 3/27 [00:23<03:07,  7.83s/it]
Epoch 3:  15%|█▍        | 4/27 [00:31<03:00,  7.84s/it]
Epoch 3:  19%|█▊        | 5/27 [00:39<02:52,  7.85s/it]
Epoch 3:  22%|██▏       | 6/27 [00:47<02:45,  7.86s/it]
Epoch 3:  26%|██▌       | 7/27 [00:54<02:37,  7.87s/it]
Epoch 3:  30%|██▉       | 8/27 [01:02<02:29,  7.87s/it]
Epoch 3:  33%|███▎      | 9/27 [01:10<02:21,  7.88s/it]
Epoch 3:  37%|███▋      | 10/27 [01:18<02:13,  7.88s/it]
Epoch 3:  41%|████      | 11/27 [01:26<02:06,  7.88s/it]
Epoch 3:  44%|████▍     | 12/27 [01:34<01:58,  7.88s/it]
Epoch 3:  48%|████▊     | 13/27 [01:42<01:50,  7.88s/it]
Epoch 3:  52%|█████▏    | 14/27 [01:50<01:42,  7.88s/it]
Epoch 3:  56%|█████▌    | 15/27 [01:58<01:34,  7.88s/it]
Epoch 3:  59%|█████▉    | 16/27 [02:05<01:26,  7.88s/it]
Epoch 3:  63%|██████▎   | 17/27 [02:13<01:18,  7.87s/it]
Epoch 3:  67%|██████▋   | 18/27 [02:21<01:10,  7.87s/it]
Epoch 3:  70%|███████   | 19/27 [02:29<01:02,  7.87s/it]
Epoch 3:  74%|███████▍  | 20/27 [02:37<00:55,  7.86s/it]
Epoch 3:  78%|███████▊  | 21/27 [02:45<00:47,  7.86s/it]
Epoch 3:  81%|████████▏ | 22/27 [02:53<00:39,  7.86s/it]
Epoch 3:  85%|████████▌ | 23/27 [03:00<00:31,  7.86s/it]
Epoch 3:  89%|████████▉ | 24/27 [03:08<00:23,  7.86s/it]
Epoch 3:  93%|█████████▎| 25/27 [03:16<00:15,  7.86s/it]
Epoch 3:  96%|█████████▋| 26/27 [03:24<00:07,  7.86s/it]
Epoch 3: 100%|██████████| 27/27 [03:27<00:00,  6.37s/it]
Epoch 3: 100%|██████████| 27/27 [03:27<00:00,  7.68s/it]
[Epoch 3] Training Loss: 1.7152

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:06<00:13,  6.55s/it]
Validation:  67%|██████▋   | 2/3 [00:13<00:06,  6.55s/it]
Validation: 100%|██████████| 3/3 [00:19<00:00,  6.38s/it]
Validation: 100%|██████████| 3/3 [00:19<00:00,  6.43s/it]
Accuracy: 37.20%, F1 Score: 0.2176

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.27      0.37      0.32       409
           2       0.00      0.00      0.00       105
           3       0.32      0.54      0.41       298
           4       0.43      0.61      0.50       673
           5       0.00      0.00      0.00       121
           6       0.35      0.30      0.32       410
           7       0.00      0.00      0.00       173
           8       0.42      0.41      0.41       669

    accuracy                           0.37      3000
   macro avg       0.20      0.25      0.22      3000
weighted avg       0.31      0.37      0.33      3000

Best model saved at epoch 3 with accuracy: 0.3720 and f1 score: 0.2176

Epoch 4:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 4:   4%|▎         | 1/27 [00:07<03:22,  7.81s/it]
Epoch 4:   7%|▋         | 2/27 [00:15<03:15,  7.81s/it]
Epoch 4:  11%|█         | 3/27 [00:23<03:07,  7.82s/it]
Epoch 4:  15%|█▍        | 4/27 [00:31<03:00,  7.83s/it]
Epoch 4:  19%|█▊        | 5/27 [00:39<02:52,  7.84s/it]
Epoch 4:  22%|██▏       | 6/27 [00:47<02:44,  7.85s/it]
Epoch 4:  26%|██▌       | 7/27 [00:54<02:37,  7.85s/it]
Epoch 4:  30%|██▉       | 8/27 [01:02<02:29,  7.86s/it]
Epoch 4:  33%|███▎      | 9/27 [01:10<02:21,  7.87s/it]
Epoch 4:  37%|███▋      | 10/27 [01:18<02:13,  7.87s/it]
Epoch 4:  41%|████      | 11/27 [01:26<02:05,  7.87s/it]
Epoch 4:  44%|████▍     | 12/27 [01:34<01:58,  7.87s/it]
Epoch 4:  48%|████▊     | 13/27 [01:42<01:50,  7.88s/it]
Epoch 4:  52%|█████▏    | 14/27 [01:50<01:42,  7.88s/it]
Epoch 4:  56%|█████▌    | 15/27 [01:58<01:35,  7.94s/it]
Epoch 4:  59%|█████▉    | 16/27 [02:06<01:27,  7.92s/it]
Epoch 4:  63%|██████▎   | 17/27 [02:13<01:19,  7.91s/it]
Epoch 4:  67%|██████▋   | 18/27 [02:21<01:11,  7.89s/it]
Epoch 4:  70%|███████   | 19/27 [02:29<01:03,  7.88s/it]
Epoch 4:  74%|███████▍  | 20/27 [02:37<00:55,  7.88s/it]
Epoch 4:  78%|███████▊  | 21/27 [02:45<00:47,  7.87s/it]
Epoch 4:  81%|████████▏ | 22/27 [02:53<00:39,  7.87s/it]
Epoch 4:  85%|████████▌ | 23/27 [03:01<00:31,  7.87s/it]
Epoch 4:  89%|████████▉ | 24/27 [03:08<00:23,  7.86s/it]
Epoch 4:  93%|█████████▎| 25/27 [03:16<00:15,  7.86s/it]
Epoch 4:  96%|█████████▋| 26/27 [03:24<00:07,  7.86s/it]
Epoch 4: 100%|██████████| 27/27 [03:27<00:00,  6.36s/it]
Epoch 4: 100%|██████████| 27/27 [03:27<00:00,  7.68s/it]
[Epoch 4] Training Loss: 1.6870

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:06<00:13,  6.55s/it]
Validation:  67%|██████▋   | 2/3 [00:13<00:06,  6.55s/it]
Validation: 100%|██████████| 3/3 [00:19<00:00,  6.39s/it]
Validation: 100%|██████████| 3/3 [00:19<00:00,  6.43s/it]
Accuracy: 37.93%, F1 Score: 0.2286

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.34      0.53      0.41       409
           2       0.00      0.00      0.00       105
           3       0.43      0.38      0.40       298
           4       0.44      0.56      0.49       673
           5       0.00      0.00      0.00       121
           6       0.33      0.47      0.39       410
           7       0.00      0.00      0.00       173
           8       0.36      0.35      0.36       669

    accuracy                           0.38      3000
   macro avg       0.21      0.26      0.23      3000
weighted avg       0.31      0.38      0.34      3000

Best model saved at epoch 4 with accuracy: 0.3793 and f1 score: 0.2286

Epoch 5:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 5:   4%|▎         | 1/27 [00:07<03:23,  7.84s/it]
Epoch 5:   7%|▋         | 2/27 [00:15<03:15,  7.83s/it]
Epoch 5:  11%|█         | 3/27 [00:23<03:07,  7.83s/it]
Epoch 5:  15%|█▍        | 4/27 [00:31<03:00,  7.84s/it]
Epoch 5:  19%|█▊        | 5/27 [00:39<02:52,  7.84s/it]
Epoch 5:  22%|██▏       | 6/27 [00:47<02:44,  7.84s/it]
Epoch 5:  26%|██▌       | 7/27 [00:54<02:36,  7.85s/it]
Epoch 5:  30%|██▉       | 8/27 [01:02<02:29,  7.85s/it]
Epoch 5:  33%|███▎      | 9/27 [01:10<02:21,  7.86s/it]
Epoch 5:  37%|███▋      | 10/27 [01:18<02:13,  7.86s/it]
Epoch 5:  41%|████      | 11/27 [01:26<02:05,  7.86s/it]
Epoch 5:  44%|████▍     | 12/27 [01:34<01:57,  7.86s/it]
Epoch 5:  48%|████▊     | 13/27 [01:42<01:50,  7.86s/it]
Epoch 5:  52%|█████▏    | 14/27 [01:49<01:42,  7.86s/it]
Epoch 5:  56%|█████▌    | 15/27 [01:57<01:34,  7.86s/it]
Epoch 5:  59%|█████▉    | 16/27 [02:05<01:26,  7.86s/it]
Epoch 5:  63%|██████▎   | 17/27 [02:13<01:18,  7.86s/it]
Epoch 5:  67%|██████▋   | 18/27 [02:21<01:10,  7.86s/it]
Epoch 5:  70%|███████   | 19/27 [02:29<01:02,  7.86s/it]
Epoch 5:  74%|███████▍  | 20/27 [02:37<00:54,  7.86s/it]
Epoch 5:  78%|███████▊  | 21/27 [02:44<00:47,  7.86s/it]
Epoch 5:  81%|████████▏ | 22/27 [02:52<00:39,  7.85s/it]
Epoch 5:  85%|████████▌ | 23/27 [03:00<00:31,  7.85s/it]
Epoch 5:  89%|████████▉ | 24/27 [03:08<00:23,  7.85s/it]
Epoch 5:  93%|█████████▎| 25/27 [03:16<00:15,  7.85s/it]
Epoch 5:  96%|█████████▋| 26/27 [03:24<00:07,  7.85s/it]
Epoch 5: 100%|██████████| 27/27 [03:27<00:00,  6.36s/it]
Epoch 5: 100%|██████████| 27/27 [03:27<00:00,  7.67s/it]
[Epoch 5] Training Loss: 1.6691

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:06<00:13,  6.55s/it]
Validation:  67%|██████▋   | 2/3 [00:13<00:06,  6.55s/it]
Validation: 100%|██████████| 3/3 [00:19<00:00,  6.37s/it]
Validation: 100%|██████████| 3/3 [00:19<00:00,  6.42s/it]
Accuracy: 37.53%, F1 Score: 0.2559

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.31      0.63      0.42       409
           2       0.26      0.41      0.32       105
           3       0.43      0.29      0.35       298
           4       0.47      0.49      0.48       673
           5       0.00      0.00      0.00       121
           6       0.37      0.35      0.36       410
           7       0.00      0.00      0.00       173
           8       0.36      0.40      0.38       669

    accuracy                           0.38      3000
   macro avg       0.25      0.28      0.26      3000
weighted avg       0.33      0.38      0.34      3000

Best model saved at epoch 5 with accuracy: 0.3753 and f1 score: 0.2559

Epoch 6:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 6:   4%|▎         | 1/27 [00:07<03:22,  7.80s/it]
Epoch 6:   7%|▋         | 2/27 [00:15<03:15,  7.81s/it]
Epoch 6:  11%|█         | 3/27 [00:23<03:07,  7.82s/it]
Epoch 6:  15%|█▍        | 4/27 [00:31<03:00,  7.83s/it]
Epoch 6:  19%|█▊        | 5/27 [00:39<02:52,  7.84s/it]
Epoch 6:  22%|██▏       | 6/27 [00:47<02:44,  7.84s/it]
Epoch 6:  26%|██▌       | 7/27 [00:54<02:37,  7.85s/it]
Epoch 6:  30%|██▉       | 8/27 [01:02<02:29,  7.86s/it]
Epoch 6:  33%|███▎      | 9/27 [01:10<02:21,  7.86s/it]
Epoch 6:  37%|███▋      | 10/27 [01:18<02:13,  7.87s/it]
Epoch 6:  41%|████      | 11/27 [01:26<02:05,  7.87s/it]
Epoch 6:  44%|████▍     | 12/27 [01:34<01:58,  7.87s/it]
Epoch 6:  48%|████▊     | 13/27 [01:42<01:50,  7.87s/it]
Epoch 6:  52%|█████▏    | 14/27 [01:49<01:42,  7.87s/it]
Epoch 6:  56%|█████▌    | 15/27 [01:57<01:34,  7.87s/it]
Epoch 6:  59%|█████▉    | 16/27 [02:05<01:26,  7.87s/it]
Epoch 6:  63%|██████▎   | 17/27 [02:13<01:18,  7.86s/it]
Epoch 6:  67%|██████▋   | 18/27 [02:21<01:10,  7.86s/it]
Epoch 6:  70%|███████   | 19/27 [02:29<01:02,  7.86s/it]
Epoch 6:  74%|███████▍  | 20/27 [02:37<00:55,  7.86s/it]
Epoch 6:  78%|███████▊  | 21/27 [02:44<00:47,  7.86s/it]
Epoch 6:  81%|████████▏ | 22/27 [02:52<00:39,  7.86s/it]
Epoch 6:  85%|████████▌ | 23/27 [03:00<00:31,  7.86s/it]
Epoch 6:  89%|████████▉ | 24/27 [03:08<00:23,  7.85s/it]
Epoch 6:  93%|█████████▎| 25/27 [03:16<00:15,  7.85s/it]
Epoch 6:  96%|█████████▋| 26/27 [03:24<00:07,  7.85s/it]
Epoch 6: 100%|██████████| 27/27 [03:27<00:00,  6.36s/it]
Epoch 6: 100%|██████████| 27/27 [03:27<00:00,  7.67s/it]
[Epoch 6] Training Loss: 1.6622

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:06<00:13,  6.54s/it]
Validation:  67%|██████▋   | 2/3 [00:13<00:06,  6.54s/it]
Validation: 100%|██████████| 3/3 [00:19<00:00,  6.38s/it]
Validation: 100%|██████████| 3/3 [00:19<00:00,  6.42s/it]
Accuracy: 39.80%, F1 Score: 0.2412

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.35      0.56      0.43       409
           2       0.39      0.24      0.30       105
           3       0.46      0.31      0.37       298
           4       0.43      0.62      0.51       673
           5       0.00      0.00      0.00       121
           6       0.44      0.05      0.09       410
           7       0.00      0.00      0.00       173
           8       0.38      0.61      0.47       669

    accuracy                           0.40      3000
   macro avg       0.27      0.27      0.24      3000
weighted avg       0.35      0.40      0.34      3000


Epoch 7:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 7:   4%|▎         | 1/27 [00:07<03:24,  7.86s/it]
Epoch 7:   7%|▋         | 2/27 [00:15<03:16,  7.86s/it]
Epoch 7:  11%|█         | 3/27 [00:23<03:08,  7.85s/it]
Epoch 7:  15%|█▍        | 4/27 [00:31<03:00,  7.85s/it]
Epoch 7:  19%|█▊        | 5/27 [00:39<02:52,  7.85s/it]
Epoch 7:  22%|██▏       | 6/27 [00:47<02:44,  7.85s/it]
Epoch 7:  26%|██▌       | 7/27 [00:54<02:36,  7.85s/it]
Epoch 7:  30%|██▉       | 8/27 [01:02<02:29,  7.85s/it]
Epoch 7:  33%|███▎      | 9/27 [01:10<02:21,  7.85s/it]
Epoch 7:  37%|███▋      | 10/27 [01:18<02:13,  7.85s/it]
Epoch 7:  41%|████      | 11/27 [01:26<02:05,  7.85s/it]
Epoch 7:  44%|████▍     | 12/27 [01:34<01:57,  7.85s/it]
Epoch 7:  48%|████▊     | 13/27 [01:42<01:49,  7.85s/it]
Epoch 7:  52%|█████▏    | 14/27 [01:49<01:42,  7.85s/it]
Epoch 7:  56%|█████▌    | 15/27 [01:57<01:34,  7.85s/it]
Epoch 7:  59%|█████▉    | 16/27 [02:05<01:26,  7.85s/it]
Epoch 7:  63%|██████▎   | 17/27 [02:13<01:19,  7.92s/it]
Epoch 7:  67%|██████▋   | 18/27 [02:21<01:11,  7.89s/it]
Epoch 7:  70%|███████   | 19/27 [02:29<01:03,  7.88s/it]
Epoch 7:  74%|███████▍  | 20/27 [02:37<00:55,  7.87s/it]
Epoch 7:  78%|███████▊  | 21/27 [02:45<00:47,  7.87s/it]
Epoch 7:  81%|████████▏ | 22/27 [02:52<00:39,  7.86s/it]
Epoch 7:  85%|████████▌ | 23/27 [03:00<00:31,  7.86s/it]
Epoch 7:  89%|████████▉ | 24/27 [03:08<00:23,  7.85s/it]
Epoch 7:  93%|█████████▎| 25/27 [03:16<00:15,  7.85s/it]
Epoch 7:  96%|█████████▋| 26/27 [03:24<00:07,  7.85s/it]
Epoch 7: 100%|██████████| 27/27 [03:27<00:00,  6.36s/it]
Epoch 7: 100%|██████████| 27/27 [03:27<00:00,  7.67s/it]
[Epoch 7] Training Loss: 1.6452

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:06<00:13,  6.55s/it]
Validation:  67%|██████▋   | 2/3 [00:13<00:06,  6.55s/it]
Validation: 100%|██████████| 3/3 [00:19<00:00,  6.39s/it]
Validation: 100%|██████████| 3/3 [00:19<00:00,  6.43s/it]
Accuracy: 39.70%, F1 Score: 0.2470

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.34      0.59      0.43       409
           2       0.37      0.37      0.37       105
           3       0.44      0.31      0.36       298
           4       0.45      0.56      0.50       673
           5       0.00      0.00      0.00       121
           6       0.36      0.04      0.07       410
           7       0.00      0.00      0.00       173
           8       0.39      0.64      0.48       669

    accuracy                           0.40      3000
   macro avg       0.26      0.28      0.25      3000
weighted avg       0.34      0.40      0.34      3000


Epoch 8:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 8:   4%|▎         | 1/27 [00:07<03:23,  7.84s/it]
Epoch 8:   7%|▋         | 2/27 [00:15<03:16,  7.85s/it]
Epoch 8:  11%|█         | 3/27 [00:23<03:08,  7.85s/it]
Epoch 8:  15%|█▍        | 4/27 [00:31<03:00,  7.85s/it]
Epoch 8:  19%|█▊        | 5/27 [00:39<02:52,  7.85s/it]
Epoch 8:  22%|██▏       | 6/27 [00:50<03:07,  8.91s/it]
Epoch 8:  26%|██▌       | 7/27 [01:06<03:45, 11.27s/it]
Epoch 8:  30%|██▉       | 8/27 [01:22<04:03, 12.82s/it]
Epoch 8:  33%|███▎      | 9/27 [01:38<04:09, 13.86s/it]
Epoch 8:  37%|███▋      | 10/27 [01:54<04:07, 14.54s/it]
Epoch 8:  41%|████      | 11/27 [02:04<03:28, 13.03s/it]
Epoch 8:  44%|████▍     | 12/27 [02:15<03:06, 12.40s/it]
Epoch 8:  48%|████▊     | 13/27 [02:31<03:10, 13.59s/it]
Epoch 8:  52%|█████▏    | 14/27 [02:47<03:07, 14.43s/it]
Epoch 8:  56%|█████▌    | 15/27 [03:04<03:00, 15.01s/it]
Epoch 8:  59%|█████▉    | 16/27 [03:20<02:49, 15.41s/it]
Epoch 8:  63%|██████▎   | 17/27 [03:31<02:20, 14.04s/it]
Epoch 8:  67%|██████▋   | 18/27 [03:47<02:11, 14.66s/it]
Epoch 8:  70%|███████   | 19/27 [04:03<02:00, 15.07s/it]
Epoch 8:  74%|███████▍  | 20/27 [04:19<01:47, 15.37s/it]
Epoch 8:  78%|███████▊  | 21/27 [04:35<01:33, 15.57s/it]
Epoch 8:  81%|████████▏ | 22/27 [04:48<01:13, 14.65s/it]
Epoch 8:  85%|████████▌ | 23/27 [05:02<00:58, 14.61s/it]
Epoch 8:  89%|████████▉ | 24/27 [05:18<00:45, 15.04s/it]
Epoch 8:  93%|█████████▎| 25/27 [05:34<00:30, 15.34s/it]
Epoch 8:  96%|█████████▋| 26/27 [05:50<00:15, 15.55s/it]
Epoch 8: 100%|██████████| 27/27 [05:56<00:00, 12.66s/it]
Epoch 8: 100%|██████████| 27/27 [05:56<00:00, 13.21s/it]
[Epoch 8] Training Loss: 1.6287

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:10<00:21, 10.62s/it]
Validation:  67%|██████▋   | 2/3 [00:22<00:11, 11.27s/it]
Validation: 100%|██████████| 3/3 [00:34<00:00, 11.81s/it]
Validation: 100%|██████████| 3/3 [00:34<00:00, 11.60s/it]
Accuracy: 38.67%, F1 Score: 0.2600

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.29      0.56      0.38       409
           2       0.39      0.30      0.34       105
           3       0.37      0.45      0.40       298
           4       0.48      0.48      0.48       673
           5       0.00      0.00      0.00       121
           6       0.41      0.21      0.28       410
           7       0.00      0.00      0.00       173
           8       0.41      0.54      0.46       669

    accuracy                           0.39      3000
   macro avg       0.26      0.28      0.26      3000
weighted avg       0.34      0.39      0.35      3000

Best model saved at epoch 8 with accuracy: 0.3867 and f1 score: 0.2600

Epoch 9:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 9:   4%|▎         | 1/27 [00:16<06:59, 16.12s/it]
Epoch 9:   7%|▋         | 2/27 [00:32<06:42, 16.11s/it]
Epoch 9:  11%|█         | 3/27 [00:47<06:21, 15.91s/it]
Epoch 9:  15%|█▍        | 4/27 [00:59<05:29, 14.31s/it]
Epoch 9:  19%|█▊        | 5/27 [01:15<05:29, 14.96s/it]
Epoch 9:  22%|██▏       | 6/27 [01:31<05:22, 15.35s/it]
Epoch 9:  26%|██▌       | 7/27 [01:47<05:11, 15.57s/it]
Epoch 9:  30%|██▉       | 8/27 [02:04<04:58, 15.72s/it]
Epoch 9:  33%|███▎      | 9/27 [02:15<04:19, 14.40s/it]
Epoch 9:  37%|███▋      | 10/27 [02:31<04:13, 14.89s/it]
Epoch 9:  41%|████      | 11/27 [02:47<04:04, 15.30s/it]
Epoch 9:  44%|████▍     | 12/27 [03:04<03:54, 15.61s/it]
Epoch 9:  48%|████▊     | 13/27 [03:20<03:40, 15.77s/it]
Epoch 9:  52%|█████▏    | 14/27 [03:32<03:13, 14.86s/it]
Epoch 9:  56%|█████▌    | 15/27 [03:46<02:55, 14.59s/it]
Epoch 9:  59%|█████▉    | 16/27 [04:02<02:45, 15.01s/it]
Epoch 9:  63%|██████▎   | 17/27 [04:18<02:33, 15.31s/it]
Epoch 9:  67%|██████▋   | 18/27 [04:34<02:19, 15.52s/it]
Epoch 9:  70%|███████   | 19/27 [04:49<02:02, 15.33s/it]
Epoch 9:  74%|███████▍  | 20/27 [05:01<01:40, 14.37s/it]
Epoch 9:  78%|███████▊  | 21/27 [05:17<01:29, 14.86s/it]
Epoch 9:  81%|████████▏ | 22/27 [05:33<01:16, 15.21s/it]
Epoch 9:  85%|████████▌ | 23/27 [05:49<01:01, 15.45s/it]
Epoch 9:  89%|████████▉ | 24/27 [06:06<00:46, 15.62s/it]
Epoch 9:  93%|█████████▎| 25/27 [06:17<00:28, 14.40s/it]
Epoch 9:  96%|█████████▋| 26/27 [06:33<00:14, 14.88s/it]
Epoch 9: 100%|██████████| 27/27 [06:39<00:00, 12.20s/it]
Epoch 9: 100%|██████████| 27/27 [06:39<00:00, 14.80s/it]
[Epoch 9] Training Loss: 1.6234

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:13<00:26, 13.33s/it]
Validation:  67%|██████▋   | 2/3 [00:26<00:13, 13.32s/it]
Validation: 100%|██████████| 3/3 [00:39<00:00, 12.90s/it]
Validation: 100%|██████████| 3/3 [00:39<00:00, 13.01s/it]
Accuracy: 37.47%, F1 Score: 0.2612

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.32      0.55      0.40       409
           2       0.24      0.50      0.33       105
           3       0.42      0.38      0.40       298
           4       0.48      0.48      0.48       673
           5       0.00      0.00      0.00       121
           6       0.31      0.50      0.38       410
           7       0.00      0.00      0.00       173
           8       0.42      0.30      0.35       669

    accuracy                           0.37      3000
   macro avg       0.24      0.30      0.26      3000
weighted avg       0.34      0.37      0.35      3000

Best model saved at epoch 9 with accuracy: 0.3747 and f1 score: 0.2612

Epoch 10:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 10:   4%|▎         | 1/27 [00:12<05:32, 12.77s/it]
Epoch 10:   7%|▋         | 2/27 [00:27<05:41, 13.67s/it]
Epoch 10:  11%|█         | 3/27 [00:43<05:57, 14.88s/it]
Epoch 10:  15%|█▍        | 4/27 [00:59<05:54, 15.40s/it]
Epoch 10:  19%|█▊        | 5/27 [01:15<05:46, 15.73s/it]
Epoch 10:  22%|██▏       | 6/27 [01:30<05:18, 15.18s/it]
Epoch 10:  26%|██▌       | 7/27 [01:43<04:50, 14.51s/it]
Epoch 10:  30%|██▉       | 8/27 [01:59<04:44, 14.99s/it]
Epoch 10:  33%|███▎      | 9/27 [02:15<04:35, 15.31s/it]
Epoch 10:  37%|███▋      | 10/27 [02:31<04:23, 15.52s/it]
Epoch 10:  41%|████      | 11/27 [02:47<04:10, 15.64s/it]
Epoch 10:  44%|████▍     | 12/27 [02:58<03:33, 14.26s/it]
Epoch 10:  48%|████▊     | 13/27 [03:14<03:27, 14.85s/it]
Epoch 10:  52%|█████▏    | 14/27 [03:30<03:18, 15.25s/it]
Epoch 10:  56%|█████▌    | 15/27 [03:46<03:06, 15.52s/it]
Epoch 10:  59%|█████▉    | 16/27 [04:02<02:52, 15.71s/it]
Epoch 10:  63%|██████▎   | 17/27 [04:14<02:25, 14.59s/it]
Epoch 10:  67%|██████▋   | 18/27 [04:30<02:14, 14.90s/it]
Epoch 10:  70%|███████   | 19/27 [04:46<02:01, 15.24s/it]
Epoch 10:  74%|███████▍  | 20/27 [05:02<01:48, 15.47s/it]
Epoch 10:  78%|███████▊  | 21/27 [05:18<01:34, 15.71s/it]
Epoch 10:  81%|████████▏ | 22/27 [05:31<01:14, 14.96s/it]
Epoch 10:  85%|████████▌ | 23/27 [05:46<00:58, 14.73s/it]
Epoch 10:  89%|████████▉ | 24/27 [06:02<00:45, 15.16s/it]
Epoch 10:  93%|█████████▎| 25/27 [06:18<00:30, 15.46s/it]
Epoch 10:  96%|█████████▋| 26/27 [06:34<00:15, 15.67s/it]
Epoch 10: 100%|██████████| 27/27 [06:40<00:00, 12.77s/it]
Epoch 10: 100%|██████████| 27/27 [06:40<00:00, 14.84s/it]
[Epoch 10] Training Loss: 1.6092

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:10<00:21, 10.78s/it]
Validation:  67%|██████▋   | 2/3 [00:21<00:11, 11.02s/it]
Validation: 100%|██████████| 3/3 [00:34<00:00, 11.68s/it]
Validation: 100%|██████████| 3/3 [00:34<00:00, 11.48s/it]
Accuracy: 39.43%, F1 Score: 0.2628

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.34      0.55      0.42       409
           2       0.30      0.40      0.34       105
           3       0.44      0.34      0.38       298
           4       0.46      0.54      0.49       673
           5       0.00      0.00      0.00       121
           6       0.38      0.21      0.27       410
           7       0.00      0.00      0.00       173
           8       0.38      0.55      0.45       669

    accuracy                           0.39      3000
   macro avg       0.26      0.29      0.26      3000
weighted avg       0.34      0.39      0.36      3000

Best model saved at epoch 10 with accuracy: 0.3943 and f1 score: 0.2628

Epoch 11:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 11:   4%|▎         | 1/27 [00:15<06:53, 15.91s/it]
Epoch 11:   7%|▋         | 2/27 [00:31<06:39, 15.99s/it]
Epoch 11:  11%|█         | 3/27 [00:47<06:24, 16.00s/it]
Epoch 11:  15%|█▍        | 4/27 [00:59<05:23, 14.06s/it]
Epoch 11:  19%|█▊        | 5/27 [01:15<05:26, 14.82s/it]
Epoch 11:  22%|██▏       | 6/27 [01:31<05:20, 15.26s/it]
Epoch 11:  26%|██▌       | 7/27 [01:47<05:11, 15.58s/it]
Epoch 11:  30%|██▉       | 8/27 [02:03<04:59, 15.76s/it]
Epoch 11:  33%|███▎      | 9/27 [02:16<04:25, 14.72s/it]
Epoch 11:  37%|███▋      | 10/27 [02:30<04:07, 14.58s/it]
Epoch 11:  41%|████      | 11/27 [02:46<04:00, 15.04s/it]
Epoch 11:  44%|████▍     | 12/27 [03:02<03:50, 15.35s/it]
Epoch 11:  48%|████▊     | 13/27 [03:18<03:37, 15.55s/it]
Epoch 11:  52%|█████▏    | 14/27 [03:33<03:18, 15.24s/it]
Epoch 11:  56%|█████▌    | 15/27 [03:45<02:50, 14.24s/it]
Epoch 11:  59%|█████▉    | 16/27 [04:01<02:42, 14.80s/it]
Epoch 11:  63%|██████▎   | 17/27 [04:17<02:31, 15.18s/it]
Epoch 11:  67%|██████▋   | 18/27 [04:33<02:18, 15.42s/it]
Epoch 11:  70%|███████   | 19/27 [04:49<02:04, 15.59s/it]
Epoch 11:  74%|███████▍  | 20/27 [05:00<01:39, 14.23s/it]
Epoch 11:  78%|███████▊  | 21/27 [05:16<01:28, 14.82s/it]
Epoch 11:  81%|████████▏ | 22/27 [05:32<01:16, 15.26s/it]
Epoch 11:  85%|████████▌ | 23/27 [05:49<01:02, 15.59s/it]
Epoch 11:  89%|████████▉ | 24/27 [06:05<00:47, 15.83s/it]
Epoch 11:  93%|█████████▎| 25/27 [06:17<00:29, 14.80s/it]
Epoch 11:  96%|█████████▋| 26/27 [06:32<00:14, 14.87s/it]
Epoch 11: 100%|██████████| 27/27 [06:38<00:00, 12.21s/it]
Epoch 11: 100%|██████████| 27/27 [06:38<00:00, 14.77s/it]
[Epoch 11] Training Loss: 1.6002

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:13<00:26, 13.46s/it]
Validation:  67%|██████▋   | 2/3 [00:26<00:13, 13.46s/it]
Validation: 100%|██████████| 3/3 [00:39<00:00, 13.03s/it]
Validation: 100%|██████████| 3/3 [00:39<00:00, 13.15s/it]
Accuracy: 37.00%, F1 Score: 0.2604

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.29      0.60      0.39       409
           2       0.31      0.43      0.36       105
           3       0.39      0.37      0.38       298
           4       0.47      0.45      0.46       673
           5       0.00      0.00      0.00       121
           6       0.34      0.46      0.39       410
           7       0.00      0.00      0.00       173
           8       0.42      0.32      0.37       669

    accuracy                           0.37      3000
   macro avg       0.25      0.29      0.26      3000
weighted avg       0.33      0.37      0.34      3000


Epoch 12:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 12:   4%|▎         | 1/27 [00:14<06:23, 14.76s/it]
Epoch 12:   7%|▋         | 2/27 [00:27<05:40, 13.63s/it]
Epoch 12:  11%|█         | 3/27 [00:43<05:55, 14.80s/it]
Epoch 12:  15%|█▍        | 4/27 [01:00<05:53, 15.38s/it]
Epoch 12:  19%|█▊        | 5/27 [01:16<05:45, 15.69s/it]
Epoch 12:  22%|██▏       | 6/27 [01:32<05:30, 15.76s/it]
Epoch 12:  26%|██▌       | 7/27 [01:43<04:48, 14.41s/it]
Epoch 12:  30%|██▉       | 8/27 [02:00<04:44, 15.00s/it]
Epoch 12:  33%|███▎      | 9/27 [02:16<04:36, 15.39s/it]
Epoch 12:  37%|███▋      | 10/27 [02:32<04:26, 15.65s/it]
Epoch 12:  41%|████      | 11/27 [02:48<04:13, 15.84s/it]
Epoch 12:  44%|████▍     | 12/27 [03:00<03:36, 14.45s/it]
Epoch 12:  48%|████▊     | 13/27 [03:16<03:29, 14.93s/it]
Epoch 12:  52%|█████▏    | 14/27 [03:32<03:18, 15.25s/it]
Epoch 12:  56%|█████▌    | 15/27 [03:48<03:05, 15.47s/it]
Epoch 12:  59%|█████▉    | 16/27 [04:04<02:51, 15.63s/it]
Epoch 12:  63%|██████▎   | 17/27 [04:17<02:28, 14.88s/it]
Epoch 12:  67%|██████▋   | 18/27 [04:27<02:01, 13.46s/it]
Epoch 12:  70%|███████   | 19/27 [04:35<01:35, 11.91s/it]
Epoch 12:  74%|███████▍  | 20/27 [04:43<01:14, 10.69s/it]
Epoch 12:  78%|███████▊  | 21/27 [04:51<00:59,  9.85s/it]
Epoch 12:  81%|████████▏ | 22/27 [04:59<00:46,  9.25s/it]
Epoch 12:  85%|████████▌ | 23/27 [05:07<00:35,  8.83s/it]
Epoch 12:  89%|████████▉ | 24/27 [05:15<00:25,  8.54s/it]
Epoch 12:  93%|█████████▎| 25/27 [05:22<00:16,  8.34s/it]
Epoch 12:  96%|█████████▋| 26/27 [05:30<00:08,  8.20s/it]
Epoch 12: 100%|██████████| 27/27 [05:33<00:00,  6.60s/it]
Epoch 12: 100%|██████████| 27/27 [05:33<00:00, 12.36s/it]
[Epoch 12] Training Loss: 1.6042

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:06<00:13,  6.56s/it]
Validation:  67%|██████▋   | 2/3 [00:13<00:06,  6.56s/it]
Validation: 100%|██████████| 3/3 [00:19<00:00,  6.39s/it]
Validation: 100%|██████████| 3/3 [00:19<00:00,  6.43s/it]
Accuracy: 39.37%, F1 Score: 0.2617

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.33      0.60      0.42       409
           2       0.34      0.33      0.33       105
           3       0.44      0.34      0.38       298
           4       0.43      0.59      0.50       673
           5       0.00      0.00      0.00       121
           6       0.40      0.22      0.28       410
           7       0.00      0.00      0.00       173
           8       0.42      0.46      0.44       669

    accuracy                           0.39      3000
   macro avg       0.26      0.28      0.26      3000
weighted avg       0.34      0.39      0.35      3000


Epoch 13:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 13:   4%|▎         | 1/27 [00:07<03:24,  7.86s/it]
Epoch 13:   7%|▋         | 2/27 [00:15<03:16,  7.86s/it]
Epoch 13:  11%|█         | 3/27 [00:23<03:08,  7.86s/it]
Epoch 13:  15%|█▍        | 4/27 [00:31<03:00,  7.86s/it]
Epoch 13:  19%|█▊        | 5/27 [00:39<02:52,  7.86s/it]
Epoch 13:  22%|██▏       | 6/27 [00:47<02:44,  7.85s/it]
Epoch 13:  26%|██▌       | 7/27 [00:54<02:37,  7.86s/it]
Epoch 13:  30%|██▉       | 8/27 [01:02<02:29,  7.86s/it]
Epoch 13:  33%|███▎      | 9/27 [01:10<02:21,  7.85s/it]
Epoch 13:  37%|███▋      | 10/27 [01:18<02:13,  7.85s/it]
Epoch 13:  41%|████      | 11/27 [01:26<02:05,  7.85s/it]
Epoch 13:  44%|████▍     | 12/27 [01:34<01:57,  7.85s/it]
Epoch 13:  48%|████▊     | 13/27 [01:42<01:49,  7.85s/it]
Epoch 13:  52%|█████▏    | 14/27 [01:51<01:49,  8.39s/it]
Epoch 13:  56%|█████▌    | 15/27 [02:08<02:10, 10.84s/it]
Epoch 13:  59%|█████▉    | 16/27 [02:24<02:17, 12.54s/it]
Epoch 13:  63%|██████▎   | 17/27 [02:41<02:18, 13.81s/it]
Epoch 13:  67%|██████▋   | 18/27 [02:58<02:11, 14.62s/it]
Epoch 13:  70%|███████   | 19/27 [03:14<02:01, 15.19s/it]
Epoch 13:  74%|███████▍  | 20/27 [03:31<01:49, 15.58s/it]
Epoch 13:  78%|███████▊  | 21/27 [03:45<01:31, 15.21s/it]
Epoch 13:  81%|████████▏ | 22/27 [04:01<01:17, 15.59s/it]
Epoch 13:  85%|████████▌ | 23/27 [04:18<01:03, 15.87s/it]
Epoch 13:  89%|████████▉ | 24/27 [04:34<00:48, 16.06s/it]
Epoch 13:  93%|█████████▎| 25/27 [04:51<00:32, 16.19s/it]
Epoch 13:  96%|█████████▋| 26/27 [05:07<00:16, 16.28s/it]
Epoch 13: 100%|██████████| 27/27 [05:13<00:00, 13.23s/it]
Epoch 13: 100%|██████████| 27/27 [05:13<00:00, 11.63s/it]
[Epoch 13] Training Loss: 1.5864

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:13<00:26, 13.17s/it]
Validation:  67%|██████▋   | 2/3 [00:25<00:12, 12.65s/it]
Validation: 100%|██████████| 3/3 [00:38<00:00, 12.74s/it]
Validation: 100%|██████████| 3/3 [00:38<00:00, 12.77s/it]
Accuracy: 40.10%, F1 Score: 0.2749

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.38      0.54      0.44       409
           2       0.37      0.34      0.35       105
           3       0.49      0.35      0.40       298
           4       0.41      0.62      0.50       673
           5       0.00      0.00      0.00       121
           6       0.36      0.38      0.37       410
           7       0.00      0.00      0.00       173
           8       0.40      0.41      0.41       669

    accuracy                           0.40      3000
   macro avg       0.27      0.29      0.27      3000
weighted avg       0.35      0.40      0.37      3000

Best model saved at epoch 13 with accuracy: 0.4010 and f1 score: 0.2749

Epoch 14:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 14:   4%|▎         | 1/27 [00:16<07:08, 16.49s/it]
Epoch 14:   7%|▋         | 2/27 [00:33<06:52, 16.51s/it]
Epoch 14:  11%|█         | 3/27 [00:49<06:36, 16.51s/it]
Epoch 14:  15%|█▍        | 4/27 [01:06<06:19, 16.51s/it]
Epoch 14:  19%|█▊        | 5/27 [01:22<05:59, 16.34s/it]
Epoch 14:  22%|██▏       | 6/27 [01:36<05:31, 15.80s/it]
Epoch 14:  26%|██▌       | 7/27 [01:53<05:20, 16.02s/it]
Epoch 14:  30%|██▉       | 8/27 [02:09<05:06, 16.16s/it]
Epoch 14:  33%|███▎      | 9/27 [02:26<04:52, 16.25s/it]
Epoch 14:  37%|███▋      | 10/27 [02:42<04:37, 16.31s/it]
Epoch 14:  41%|████      | 11/27 [02:59<04:21, 16.36s/it]
Epoch 14:  44%|████▍     | 12/27 [03:15<04:05, 16.34s/it]
Epoch 14:  48%|████▊     | 13/27 [03:30<03:41, 15.81s/it]
Epoch 14:  52%|█████▏    | 14/27 [03:46<03:28, 16.02s/it]
Epoch 14:  56%|█████▌    | 15/27 [04:03<03:14, 16.17s/it]
Epoch 14:  59%|█████▉    | 16/27 [04:19<02:58, 16.27s/it]
Epoch 14:  63%|██████▎   | 17/27 [04:36<02:43, 16.34s/it]
Epoch 14:  67%|██████▋   | 18/27 [04:52<02:27, 16.39s/it]
Epoch 14:  70%|███████   | 19/27 [05:08<02:10, 16.35s/it]
Epoch 14:  74%|███████▍  | 20/27 [05:23<01:50, 15.74s/it]
Epoch 14:  78%|███████▊  | 21/27 [05:39<01:35, 15.96s/it]
Epoch 14:  81%|████████▏ | 22/27 [05:56<01:20, 16.12s/it]
Epoch 14:  85%|████████▌ | 23/27 [06:12<01:04, 16.23s/it]
Epoch 14:  89%|████████▉ | 24/27 [06:29<00:48, 16.30s/it]
Epoch 14:  93%|█████████▎| 25/27 [06:45<00:32, 16.35s/it]
Epoch 14:  96%|█████████▋| 26/27 [07:01<00:16, 16.38s/it]
Epoch 14: 100%|██████████| 27/27 [07:07<00:00, 13.09s/it]
Epoch 14: 100%|██████████| 27/27 [07:07<00:00, 15.83s/it]
[Epoch 14] Training Loss: 1.5826

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:12<00:24, 12.41s/it]
Validation:  67%|██████▋   | 2/3 [00:26<00:13, 13.22s/it]
Validation: 100%|██████████| 3/3 [00:39<00:00, 13.06s/it]
Validation: 100%|██████████| 3/3 [00:39<00:00, 13.03s/it]
Accuracy: 40.63%, F1 Score: 0.2723

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.36      0.53      0.42       409
           2       0.33      0.42      0.37       105
           3       0.41      0.42      0.42       298
           4       0.44      0.59      0.50       673
           5       0.00      0.00      0.00       121
           6       0.45      0.20      0.28       410
           7       0.00      0.00      0.00       173
           8       0.41      0.53      0.46       669

    accuracy                           0.41      3000
   macro avg       0.27      0.30      0.27      3000
weighted avg       0.35      0.41      0.37      3000


Epoch 15:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 15:   4%|▎         | 1/27 [00:16<07:09, 16.51s/it]
Epoch 15:   7%|▋         | 2/27 [00:33<06:52, 16.51s/it]
Epoch 15:  11%|█         | 3/27 [00:49<06:36, 16.51s/it]
Epoch 15:  15%|█▍        | 4/27 [01:06<06:19, 16.51s/it]
Epoch 15:  19%|█▊        | 5/27 [01:20<05:49, 15.88s/it]
Epoch 15:  22%|██▏       | 6/27 [01:37<05:39, 16.15s/it]
Epoch 15:  26%|██▌       | 7/27 [01:54<05:26, 16.32s/it]
Epoch 15:  30%|██▉       | 8/27 [02:10<05:12, 16.43s/it]
Epoch 15:  33%|███▎      | 9/27 [02:27<04:56, 16.49s/it]
Epoch 15:  37%|███▋      | 10/27 [02:44<04:41, 16.54s/it]
Epoch 15:  41%|████      | 11/27 [03:00<04:25, 16.58s/it]
Epoch 15:  44%|████▍     | 12/27 [03:15<04:00, 16.05s/it]
Epoch 15:  48%|████▊     | 13/27 [03:32<03:46, 16.19s/it]
Epoch 15:  52%|█████▏    | 14/27 [03:48<03:31, 16.28s/it]
Epoch 15:  56%|█████▌    | 15/27 [04:05<03:16, 16.35s/it]
Epoch 15:  59%|█████▉    | 16/27 [04:21<03:00, 16.39s/it]
Epoch 15:  63%|██████▎   | 17/27 [04:38<02:44, 16.41s/it]
Epoch 15:  67%|██████▋   | 18/27 [04:54<02:27, 16.41s/it]
Epoch 15:  70%|███████   | 19/27 [05:09<02:07, 15.91s/it]
Epoch 15:  74%|███████▍  | 20/27 [05:25<01:52, 16.14s/it]
Epoch 15:  78%|███████▊  | 21/27 [05:42<01:37, 16.31s/it]
Epoch 15:  81%|████████▏ | 22/27 [05:59<01:22, 16.42s/it]
Epoch 15:  85%|████████▌ | 23/27 [06:15<01:05, 16.49s/it]
Epoch 15:  89%|████████▉ | 24/27 [06:32<00:49, 16.51s/it]
Epoch 15:  93%|█████████▎| 25/27 [06:48<00:32, 16.39s/it]
Epoch 15:  96%|█████████▋| 26/27 [07:03<00:16, 16.09s/it]
Epoch 15: 100%|██████████| 27/27 [07:10<00:00, 13.09s/it]
Epoch 15: 100%|██████████| 27/27 [07:10<00:00, 15.93s/it]
[Epoch 15] Training Loss: 1.5605

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:13<00:27, 13.76s/it]
Validation:  67%|██████▋   | 2/3 [00:27<00:13, 13.78s/it]
Validation: 100%|██████████| 3/3 [00:40<00:00, 13.36s/it]
Validation: 100%|██████████| 3/3 [00:40<00:00, 13.47s/it]
Accuracy: 40.00%, F1 Score: 0.2589

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.35      0.53      0.42       409
           2       0.39      0.21      0.27       105
           3       0.41      0.43      0.42       298
           4       0.44      0.57      0.50       673
           5       0.00      0.00      0.00       121
           6       0.40      0.19      0.26       410
           7       0.00      0.00      0.00       173
           8       0.39      0.55      0.46       669

    accuracy                           0.40      3000
   macro avg       0.27      0.28      0.26      3000
weighted avg       0.34      0.40      0.36      3000


Epoch 16:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 16:   4%|▎         | 1/27 [00:16<07:08, 16.49s/it]
Epoch 16:   7%|▋         | 2/27 [00:32<06:51, 16.48s/it]
Epoch 16:  11%|█         | 3/27 [00:46<06:01, 15.08s/it]
Epoch 16:  15%|█▍        | 4/27 [01:01<05:42, 14.90s/it]
Epoch 16:  19%|█▊        | 5/27 [01:16<05:30, 15.02s/it]
Epoch 16:  22%|██▏       | 6/27 [01:32<05:25, 15.52s/it]
Epoch 16:  26%|██▌       | 7/27 [01:49<05:16, 15.84s/it]
Epoch 16:  30%|██▉       | 8/27 [02:05<05:05, 16.06s/it]
Epoch 16:  33%|███▎      | 9/27 [02:22<04:51, 16.20s/it]
Epoch 16:  37%|███▋      | 10/27 [02:38<04:36, 16.29s/it]
Epoch 16:  41%|████      | 11/27 [02:54<04:16, 16.02s/it]
Epoch 16:  44%|████▍     | 12/27 [03:09<03:59, 15.94s/it]
Epoch 16:  48%|████▊     | 13/27 [03:26<03:45, 16.09s/it]
Epoch 16:  52%|█████▏    | 14/27 [03:42<03:30, 16.21s/it]
Epoch 16:  56%|█████▌    | 15/27 [03:59<03:15, 16.28s/it]
Epoch 16:  59%|█████▉    | 16/27 [04:08<02:35, 14.10s/it]
Epoch 16:  63%|██████▎   | 17/27 [04:21<02:18, 13.84s/it]
Epoch 16:  67%|██████▋   | 18/27 [04:38<02:11, 14.63s/it]
Epoch 16:  70%|███████   | 19/27 [04:53<01:59, 14.98s/it]
Epoch 16:  74%|███████▍  | 20/27 [05:09<01:45, 15.08s/it]
Epoch 16:  78%|███████▊  | 21/27 [05:25<01:33, 15.57s/it]
Epoch 16:  81%|████████▏ | 22/27 [05:42<01:19, 15.86s/it]
Epoch 16:  85%|████████▌ | 23/27 [05:58<01:04, 16.06s/it]
Epoch 16:  89%|████████▉ | 24/27 [06:15<00:48, 16.19s/it]
Epoch 16:  93%|█████████▎| 25/27 [06:31<00:32, 16.29s/it]
Epoch 16:  96%|█████████▋| 26/27 [06:47<00:16, 16.10s/it]
Epoch 16: 100%|██████████| 27/27 [06:52<00:00, 12.81s/it]
Epoch 16: 100%|██████████| 27/27 [06:52<00:00, 15.29s/it]
[Epoch 16] Training Loss: 1.5630

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:13<00:27, 13.70s/it]
Validation:  67%|██████▋   | 2/3 [00:27<00:13, 13.73s/it]
Validation: 100%|██████████| 3/3 [00:40<00:00, 13.31s/it]
Validation: 100%|██████████| 3/3 [00:40<00:00, 13.42s/it]
Accuracy: 39.03%, F1 Score: 0.2711

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.32      0.59      0.42       409
           2       0.34      0.40      0.37       105
           3       0.42      0.39      0.40       298
           4       0.44      0.52      0.48       673
           5       0.00      0.00      0.00       121
           6       0.37      0.35      0.36       410
           7       0.00      0.00      0.00       173
           8       0.43      0.41      0.42       669

    accuracy                           0.39      3000
   macro avg       0.26      0.30      0.27      3000
weighted avg       0.34      0.39      0.36      3000


Epoch 17:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 17:   4%|▎         | 1/27 [00:16<07:07, 16.43s/it]
Epoch 17:   7%|▋         | 2/27 [00:32<06:50, 16.42s/it]
Epoch 17:  11%|█         | 3/27 [00:49<06:34, 16.43s/it]
Epoch 17:  15%|█▍        | 4/27 [01:04<06:11, 16.14s/it]
Epoch 17:  19%|█▊        | 5/27 [01:20<05:46, 15.75s/it]
Epoch 17:  22%|██▏       | 6/27 [01:36<05:36, 16.01s/it]
Epoch 17:  26%|██▌       | 7/27 [01:53<05:23, 16.17s/it]
Epoch 17:  30%|██▉       | 8/27 [02:09<05:09, 16.28s/it]
Epoch 17:  33%|███▎      | 9/27 [02:26<04:54, 16.35s/it]
Epoch 17:  37%|███▋      | 10/27 [02:42<04:38, 16.39s/it]
Epoch 17:  41%|████      | 11/27 [02:58<04:20, 16.26s/it]
Epoch 17:  44%|████▍     | 12/27 [03:13<03:59, 15.99s/it]
Epoch 17:  48%|████▊     | 13/27 [03:30<03:46, 16.18s/it]
Epoch 17:  52%|█████▏    | 14/27 [03:47<03:32, 16.33s/it]
Epoch 17:  56%|█████▌    | 15/27 [04:03<03:17, 16.42s/it]
Epoch 17:  59%|█████▉    | 16/27 [04:20<03:01, 16.48s/it]
Epoch 17:  63%|██████▎   | 17/27 [04:37<02:45, 16.52s/it]
Epoch 17:  67%|██████▋   | 18/27 [04:52<02:26, 16.32s/it]
Epoch 17:  70%|███████   | 19/27 [05:07<02:07, 15.93s/it]
Epoch 17:  74%|███████▍  | 20/27 [05:24<01:52, 16.10s/it]
Epoch 17:  78%|███████▊  | 21/27 [05:40<01:36, 16.14s/it]
Epoch 17:  81%|████████▏ | 22/27 [05:57<01:21, 16.26s/it]
Epoch 17:  85%|████████▌ | 23/27 [06:13<01:05, 16.33s/it]
Epoch 17:  89%|████████▉ | 24/27 [06:30<00:49, 16.38s/it]
Epoch 17:  93%|█████████▎| 25/27 [06:45<00:32, 16.19s/it]
Epoch 17:  96%|█████████▋| 26/27 [07:00<00:15, 15.81s/it]
Epoch 17: 100%|██████████| 27/27 [07:06<00:00, 12.91s/it]
Epoch 17: 100%|██████████| 27/27 [07:06<00:00, 15.81s/it]
[Epoch 17] Training Loss: 1.5452

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:13<00:27, 13.77s/it]
Validation:  67%|██████▋   | 2/3 [00:27<00:13, 13.78s/it]
Validation: 100%|██████████| 3/3 [00:40<00:00, 13.37s/it]
Validation: 100%|██████████| 3/3 [00:40<00:00, 13.48s/it]
Accuracy: 38.97%, F1 Score: 0.2632

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.34      0.55      0.42       409
           2       0.28      0.39      0.33       105
           3       0.45      0.33      0.38       298
           4       0.45      0.50      0.47       673
           5       0.00      0.00      0.00       121
           6       0.35      0.30      0.32       410
           7       0.00      0.00      0.00       173
           8       0.40      0.52      0.45       669

    accuracy                           0.39      3000
   macro avg       0.25      0.29      0.26      3000
weighted avg       0.34      0.39      0.36      3000


Epoch 18:   0%|          | 0/27 [00:00<?, ?it/s]
Epoch 18:   4%|▎         | 1/27 [00:16<07:08, 16.49s/it]
Epoch 18:   7%|▋         | 2/27 [00:32<06:52, 16.49s/it]
Epoch 18:  11%|█         | 3/27 [00:49<06:32, 16.34s/it]
Epoch 18:  15%|█▍        | 4/27 [01:04<06:06, 15.91s/it]
Epoch 18:  19%|█▊        | 5/27 [01:20<05:54, 16.13s/it]
Epoch 18:  22%|██▏       | 6/27 [01:37<05:41, 16.26s/it]
Epoch 18:  26%|██▌       | 7/27 [01:53<05:26, 16.32s/it]
Epoch 18:  30%|██▉       | 8/27 [02:10<05:11, 16.39s/it]
Epoch 18:  33%|███▎      | 9/27 [02:26<04:55, 16.43s/it]
Epoch 18:  37%|███▋      | 10/27 [02:42<04:36, 16.29s/it]
Epoch 18:  41%|████      | 11/27 [02:58<04:15, 15.95s/it]
Epoch 18:  44%|████▍     | 12/27 [03:14<04:01, 16.11s/it]
Epoch 18:  48%|████▊     | 13/27 [03:31<03:46, 16.21s/it]
Epoch 18:  52%|█████▏    | 14/27 [03:47<03:31, 16.29s/it]
Epoch 18:  56%|█████▌    | 15/27 [04:03<03:16, 16.35s/it]
Epoch 18:  59%|█████▉    | 16/27 [04:20<03:00, 16.39s/it]
Epoch 18:  63%|██████▎   | 17/27 [04:36<02:42, 16.26s/it]
Epoch 18:  67%|██████▋   | 18/27 [04:51<02:24, 16.01s/it]
Epoch 18:  70%|███████   | 19/27 [05:08<02:09, 16.16s/it]
Epoch 18:  74%|███████▍  | 20/27 [05:24<01:53, 16.27s/it]
Epoch 18:  78%|███████▊  | 21/27 [05:41<01:38, 16.34s/it]
Epoch 18:  81%|████████▏ | 22/27 [05:57<01:21, 16.39s/it]
Epoch 18:  85%|████████▌ | 23/27 [06:14<01:05, 16.42s/it]
Epoch 18:  89%|████████▉ | 24/27 [06:30<00:48, 16.25s/it]
Epoch 18:  93%|█████████▎| 25/27 [06:45<00:31, 15.97s/it]
Epoch 18:  96%|█████████▋| 26/27 [07:01<00:16, 16.11s/it]
Epoch 18: 100%|██████████| 27/27 [07:08<00:00, 13.11s/it]
Epoch 18: 100%|██████████| 27/27 [07:08<00:00, 15.86s/it]
[Epoch 18] Training Loss: 1.5422

Validation:   0%|          | 0/3 [00:00<?, ?it/s]
Validation:  33%|███▎      | 1/3 [00:13<00:27, 13.77s/it]
Validation:  67%|██████▋   | 2/3 [00:27<00:13, 13.77s/it]
Validation: 100%|██████████| 3/3 [00:40<00:00, 13.36s/it]
Validation: 100%|██████████| 3/3 [00:40<00:00, 13.47s/it]
Accuracy: 38.40%, F1 Score: 0.2625

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       142
           1       0.31      0.61      0.41       409
           2       0.28      0.40      0.33       105
           3       0.41      0.38      0.39       298
           4       0.44      0.48      0.46       673
           5       0.00      0.00      0.00       121
           6       0.39      0.29      0.33       410
           7       0.00      0.00      0.00       173
           8       0.42      0.46      0.44       669

    accuracy                           0.38      3000
   macro avg       0.25      0.29      0.26      3000
weighted avg       0.34      0.38      0.35      3000

Early stopping at epoch 18


----- Starting Evaluation on Test Set -----


Test:   0%|          | 0/8 [00:00<?, ?it/s]
Test:  12%|█▎        | 1/8 [00:08<00:56,  8.01s/it]
Test:  25%|██▌       | 2/8 [00:14<00:43,  7.24s/it]
Test:  38%|███▊      | 3/8 [00:21<00:35,  7.01s/it]
Test:  50%|█████     | 4/8 [00:28<00:27,  6.91s/it]
Test:  62%|██████▎   | 5/8 [00:35<00:20,  6.94s/it]
Test:  75%|███████▌  | 6/8 [00:41<00:13,  6.88s/it]
Test:  88%|████████▊ | 7/8 [00:48<00:06,  6.84s/it]
Test: 100%|██████████| 8/8 [00:50<00:00,  5.36s/it]
Test: 100%|██████████| 8/8 [00:50<00:00,  6.36s/it]
Accuracy: 38.75%, F1 Score: 0.2655

Detailed Report:
               precision    recall  f1-score   support

           0       0.00      0.00      0.00       354
           1       0.35      0.51      0.41      1023
           2       0.31      0.32      0.31       263
           3       0.51      0.36      0.42       745
           4       0.39      0.56      0.46      1682
           5       0.00      0.00      0.00       301
           6       0.37      0.36      0.37      1025
           7       0.00      0.00      0.00       434
           8       0.40      0.42      0.41      1673

    accuracy                           0.39      7500
   macro avg       0.26      0.28      0.27      7500
weighted avg       0.34      0.39      0.36      7500
